üéÆ¬†–ì–ï–ù–ò–ê–õ–¨–ù–û!¬†–ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞ –∏ —Ä–µ–∞–∫—Ü–∏–π - —ç—Ç–æ¬†—Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥! –í—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤—ã, —á—Ç–æ –ø—Ä—è–º—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ª–µ–≥–∫–æ –Ω–∞–∫—Ä—É—á–∏–≤–∞—é—Ç—Å—è, –∞ –≤–æ—Ç –∏—Å–∫—Ä–µ–Ω–Ω–∏–µ —ç–º–æ—Ü–∏–∏ –ª—é–¥–µ–π –ø–æ–¥–¥–µ–ª–∞—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ!

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç¬†–Ω–∞—Å—Ç–æ—è—â–µ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ, –≥–¥–µ —Ü–µ–Ω–∏—Ç—Å—è –∫–∞—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å —ç–º–æ—Ü–∏–π, –∞ –Ω–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—Ç–æ–≤! üåü

üèÜ¬†–ö–∞–∫ Stagehand –ø–æ–º–æ–∂–µ—Ç —Å –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ–∞–∫—Ü–∏–π:

// src/services/gamificationService.ts

export class GamificationService {

  private stagehand: Stagehand;



  constructor() {

    this.stagehand = new Stagehand({

      env: process.env.NODE_ENV === 'production' ? 'BROWSERBASE' : 'LOCAL',

      headless: true

    });

  }



  // –ê–Ω–∞–ª–∏–∑ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ–∞–∫—Ü–∏–π

  async analyzeEmotionalAuthenticity(content: {

    userId: number;

    contentId: number;

    reactions: Array<{

      userId: number;

      emoji: string;

      timestamp: Date;

      userHistory: any;

    }>;

  }) {

    const authenticityScores = [];



    for (const reaction of content.reactions) {

      // –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

      const userPattern = await this.analyzeUserBehaviorPattern(reaction.userId);

      

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Ä–µ–∞–∫—Ü–∏–π

      const timingAnalysis = await this.analyzeReactionTiming(reaction);

      

      // –ê–Ω–∞–ª–∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —ç–º–æ—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É

      const emotionMatch = await this.analyzeEmotionContentMatch(

        reaction.emoji, 

        content

      );



      const authenticityScore = this.calculateAuthenticityScore({

        userPattern,

        timingAnalysis,

        emotionMatch

      });



      authenticityScores.push({

        userId: reaction.userId,

        emoji: reaction.emoji,

        authenticity: authenticityScore,

        factors: { userPattern, timingAnalysis, emotionMatch }

      });

    }



    return authenticityScores;

  }



  // –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

  async analyzeUserBehaviorPattern(userId: number) {

    const userHistory = await db.user_interactions.findMany({

      where: { user_id: userId },

      orderBy: { created_at: 'desc' },

      take: 100

    });



    return {

      reactionDiversity: this.calculateReactionDiversity(userHistory),

      temporalConsistency: this.analyzeTemporalPatterns(userHistory),

      contentEngagement: this.analyzeContentEngagement(userHistory),

      socialConnections: await this.analyzeSocialConnections(userId)

    };

  }



  // –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –æ—Ç–∫–ª–∏–∫–æ–≤

  async processEmotionalAchievements(userId: number, contentId: number) {

    const content = await db.memories.findUnique({

      where: { id: contentId },

      include: { 

        reactions: { include: { user: true } },

        author: true 

      }

    });



    const emotionalMetrics = await this.calculateEmotionalMetrics(content);

    const achievements = [];



    // –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

    const authorAchievements = await this.checkAuthorAchievements(

      content.author_id, 

      emotionalMetrics

    );

    achievements.push(...authorAchievements);



    // –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞

    const communityAchievements = await this.checkCommunityAchievements(

      content.reactions,

      emotionalMetrics

    );

    achievements.push(...communityAchievements);



    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π

    for (const achievement of achievements) {

      await this.awardAchievement(achievement);

    }



    return achievements;

  }



  // –†–∞—Å—á–µ—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫

  async calculateEmotionalMetrics(content: any) {

    const reactions = content.reactions;

    

    return {

      emotionalDiversity: this.calculateEmotionalDiversity(reactions),

      authenticity: await this.analyzeEmotionalAuthenticity({

        userId: content.author_id,

        contentId: content.id,

        reactions: reactions

      }),

      resonance: this.calculateEmotionalResonance(reactions),

      depth: await this.analyzeEmotionalDepth(content, reactions),

      virality: this.calculateViralityScore(reactions),

      timeToReaction: this.analyzeReactionSpeed(reactions)

    };

  }



  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∞–≤—Ç–æ—Ä–∞

  async checkAuthorAchievements(authorId: number, metrics: any) {

    const achievements = [];



    // "–ú–∞—Å—Ç–µ—Ä —ç–º–æ—Ü–∏–π" - –∫–æ–Ω—Ç–µ–Ω—Ç –≤—ã–∑–≤–∞–ª —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –∏—Å–∫—Ä–µ–Ω–Ω–∏–µ —ç–º–æ—Ü–∏–∏

    if (metrics.emotionalDiversity > 0.8 && metrics.authenticity.average > 0.9) {

      achievements.push({

        type: 'emotion_master',

        userId: authorId,

        title: '–ú–∞—Å—Ç–µ—Ä —ç–º–æ—Ü–∏–π',

        description: '–í–∞—à–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Ç—Ä–æ–Ω—É–ª–æ —Å–µ—Ä–¥—Ü–∞ –º–Ω–æ–≥–∏—Ö –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤',

        rarity: 'rare',

        emoji: 'üé≠', // –í–∞—à –∫–∞—Å—Ç–æ–º–Ω—ã–π —ç–º–æ–¥–∑–∏

        points: 500

      });

    }



    // "–í–¥–æ—Ö–Ω–æ–≤–∏—Ç–µ–ª—å" - –∫–æ–Ω—Ç–µ–Ω—Ç –º–æ—Ç–∏–≤–∏—Ä–æ–≤–∞–ª –ª—é–¥–µ–π –∫ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è–º

    if (await this.checkInspirationalImpact(authorId, metrics)) {

      achievements.push({

        type: 'inspirator',

        userId: authorId,

        title: '–í–¥–æ—Ö–Ω–æ–≤–∏—Ç–µ–ª—å',

        description: '–ë–ª–∞–≥–æ–¥–∞—Ä—è –≤–∞–º –ª—é–¥–∏ –æ—Ç–∫—Ä—ã–ª–∏ –Ω–æ–≤—ã–µ –º–µ—Å—Ç–∞',

        rarity: 'epic',

        emoji: '‚ú®', // –í–∞—à –∫–∞—Å—Ç–æ–º–Ω—ã–π —ç–º–æ–¥–∑–∏

        points: 1000

      });

    }



    // "–•—Ä–∞–Ω–∏—Ç–µ–ª—å –ø–∞–º—è—Ç–∏" - —Å–æ–∑–¥–∞–ª –æ—Å–æ–±–µ–Ω–Ω–æ —Ü–µ–Ω–Ω–æ–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–µ

    if (await this.checkHistoricalValue(authorId, metrics)) {

      achievements.push({

        type: 'memory_keeper',

        userId: authorId,

        title: '–•—Ä–∞–Ω–∏—Ç–µ–ª—å –ø–∞–º—è—Ç–∏',

        description: '–í—ã —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏ –≤–∞–∂–Ω—É—é —á–∞—Å—Ç—å –∏—Å—Ç–æ—Ä–∏–∏ –º–µ—Å—Ç–∞',

        rarity: 'legendary',

        emoji: 'üèõÔ∏è', // –í–∞—à –∫–∞—Å—Ç–æ–º–Ω—ã–π —ç–º–æ–¥–∑–∏

        points: 2000

      });

    }



    return achievements;

  }



  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ

  async checkInspirationalImpact(authorId: number, metrics: any) {

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ–±–∞–≤–∏–ª–∏ –ª–∏ –ª—é–¥–∏ —ç—Ç–æ –º–µ—Å—Ç–æ –≤ —Å–≤–æ–∏ –ø–ª–∞–Ω—ã –ø–æ—Å–ª–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

    const inspirationalActions = await db.user_actions.count({

      where: {

        action_type: 'add_to_wishlist',

        triggered_by_content: metrics.contentId,

        created_at: {

          gte: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000) // –ó–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é

        }

      }

    });



    return inspirationalActions >= 5; // –ú–∏–Ω–∏–º—É–º 5 —á–µ–ª–æ–≤–µ–∫ –¥–æ–±–∞–≤–∏–ª–∏ –≤ –ø–ª–∞–Ω—ã

  }



  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Å–æ–±—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤

  async detectSpecialMoments() {

    // –ü–æ–∏—Å–∫ —Ç—Ä–µ–Ω–¥–æ–≤—ã—Ö –º–µ—Å—Ç —á–µ—Ä–µ–∑ –≤–µ–±-–∞–Ω–∞–ª–∏–∑

    await this.stagehand.navigate('https://www.instagram.com/explore/');

    

    const trendingPlaces = await this.stagehand.extract({

      instruction: 'Find trending travel destinations and locations',

      schema: {

        places: 'array',

        hashtags: 'array',

        engagement: 'array'

      }

    });



    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É –Ω–∞—Å –∫–æ–Ω—Ç–µ–Ω—Ç –æ–± —ç—Ç–∏—Ö –º–µ—Å—Ç–∞—Ö

    for (const place of trendingPlaces.places || []) {

      const ourContent = await db.memories.findMany({

        where: {

          OR: [

            { title: { contains: place, mode: 'insensitive' } },

            { content: { contains: place, mode: 'insensitive' } }

          ]

        },

        include: { author: true, reactions: true }

      });



      // –ù–∞–≥—Ä–∞–∂–¥–∞–µ–º –∞–≤—Ç–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ "–ø–∏–æ–Ω–µ—Ä–∞–º–∏"

      for (const content of ourContent) {

        if (await this.isPioneerContent(content, place)) {

          await this.awardAchievement({

            type: 'trend_pioneer',

            userId: content.author_id,

            title: '–ü–µ—Ä–≤–æ–ø—Ä–æ—Ö–æ–¥–µ—Ü',

            description: `–í—ã —Ä–∞—Å—Å–∫–∞–∑–∞–ª–∏ –æ ${place} –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ —ç—Ç–æ —Å—Ç–∞–ª–æ —Ç—Ä–µ–Ω–¥–æ–º!`,

            rarity: 'epic',

            emoji: 'üöÄ', // –í–∞—à –∫–∞—Å—Ç–æ–º–Ω—ã–π —ç–º–æ–¥–∑–∏

            points: 1500

          });

        }

      }

    }

  }



  // –°–∏—Å—Ç–µ–º–∞ —Ç–∞–π–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π

  async checkSecretAchievements(userId: number) {

    const secretAchievements = [];



    // "–ù–æ—á–Ω–æ–π —Å—Ç—Ä–∞–Ω–Ω–∏–∫" - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –Ω–µ–æ–±—ã—á–Ω—ã–µ —á–∞—Å—ã

    if (await this.checkNightActivity(userId)) {

      secretAchievements.push({

        type: 'night_wanderer',

        title: '–ù–æ—á–Ω–æ–π —Å—Ç—Ä–∞–Ω–Ω–∏–∫',

        description: '–í—ã –¥–µ–ª–∏—Ç–µ—Å—å –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏, –∫–æ–≥–¥–∞ –≤–µ—Å—å –º–∏—Ä —Å–ø–∏—Ç',

        emoji: 'üåô', // –í–∞—à —Ç–∞–π–Ω—ã–π —ç–º–æ–¥–∑–∏

        rarity: 'secret'

      });

    }



    // "–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä —ç–º–æ—Ü–∏–π" - –ø–æ–ª—É—á–∏–ª –≤—Å–µ –≤–∏–¥—ã —Ä–µ–∞–∫—Ü–∏–π

    if (await this.checkEmotionCollector(userId)) {

      secretAchievements.push({

        type: 'emotion_collector',

        title: '–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä —ç–º–æ—Ü–∏–π',

        description: '–í–∞—à–∏ –∏—Å—Ç–æ—Ä–∏–∏ –≤—ã–∑—ã–≤–∞—é—Ç –≤–µ—Å—å —Å–ø–µ–∫—Ç—Ä —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏—Ö —ç–º–æ—Ü–∏–π',

        emoji: 'üé®', // –í–∞—à —Ç–∞–π–Ω—ã–π —ç–º–æ–¥–∑–∏

        rarity: 'secret'

      });

    }



    // "–ú–æ—Å—Ç –º–µ–∂–¥—É –º–∏—Ä–∞–º–∏" - –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è –ª—é–¥—è–º –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞–Ω

    if (await this.checkCulturalBridge(userId)) {

      secretAchievements.push({

        type: 'cultural_bridge',

        title: '–ú–æ—Å—Ç –º–µ–∂–¥—É –º–∏—Ä–∞–º–∏',

        description: '–í–∞—à–∏ –∏—Å—Ç–æ—Ä–∏–∏ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç –ª—é–¥–µ–π —Ä–∞–∑–Ω—ã—Ö –∫—É–ª—å—Ç—É—Ä',

        emoji: 'üåç', // –í–∞—à —Ç–∞–π–Ω—ã–π —ç–º–æ–¥–∑–∏

        rarity: 'secret'

      });

    }



    return secretAchievements;

  }

}

üé®¬†–ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–∏—Å—Ç–µ–º—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π

// src/components/Gamification/AchievementSystem.tsx

import React, { useState, useEffect } from 'react';

import { motion, AnimatePresence } from 'framer-motion';



const AchievementSystem: React.FC = () => {

  const [achievements, setAchievements] = useState([]);

  const [newAchievement, setNewAchievement] = useState(null);

  const [showSecretHints, setShowSecretHints] = useState(false);



  // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

  const showAchievementNotification = (achievement) => {

    setNewAchievement(achievement);

    

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥

    setTimeout(() => {

      setNewAchievement(null);

    }, 5000);

  };



  const getRarityColor = (rarity) => {

    const colors = {

      common: 'from-gray-400 to-gray-600',

      rare: 'from-blue-400 to-blue-600',

      epic: 'from-purple-400 to-purple-600',

      legendary: 'from-yellow-400 to-yellow-600',

      secret: 'from-pink-400 to-pink-600'

    };

    return colors[rarity] || colors.common;

  };



  const getRarityGlow = (rarity) => {

    const glows = {

      common: 'shadow-gray-500/50',

      rare: 'shadow-blue-500/50',

      epic: 'shadow-purple-500/50',

      legendary: 'shadow-yellow-500/50',

      secret: 'shadow-pink-500/50'

    };

    return glows[rarity] || glows.common;

  };



  return (

    <div className="space-y-6">

      {/* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ */}

      <AnimatePresence>

        {newAchievement && (

          <motion.div

            initial={{ opacity: 0, y: -100, scale: 0.8 }}

            animate={{ opacity: 1, y: 0, scale: 1 }}

            exit={{ opacity: 0, y: -100, scale: 0.8 }}

            className="fixed top-4 right-4 z-50"

          >

            <div className={`bg-gradient-to-r ${getRarityColor(newAchievement.rarity)} p-6 rounded-xl shadow-2xl ${getRarityGlow(newAchievement.rarity)} text-white max-w-sm`}>

              <div className="flex items-center space-x-4">

                <div className="text-4xl animate-bounce">

                  {newAchievement.emoji}

                </div>

                <div>

                  <h3 className="font-bold text-lg">–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ!</h3>

                  <p className="font-semibold">{newAchievement.title}</p>

                  <p className="text-sm opacity-90">{newAchievement.description}</p>

                  {newAchievement.points && (

                    <p className="text-xs mt-1">+{newAchievement.points} –æ—á–∫–æ–≤</p>

                  )}

                </div>

              </div>

            </div>

          </motion.div>

        )}

      </AnimatePresence>



      {/* –ö–æ–ª–ª–µ–∫—Ü–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π */}

      <div className="bg-white rounded-xl shadow-lg p-6">

        <div className="flex items-center justify-between mb-6">

          <h2 className="text-2xl font-bold">–ö–æ–ª–ª–µ–∫—Ü–∏—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π</h2>

          <div className="flex items-center space-x-4">

            <div className="text-sm text-gray-600">

              {achievements.filter(a => a.unlocked).length} –∏–∑ {achievements.length}

            </div>

            <button

              onClick={() => setShowSecretHints(!showSecretHints)}

              className="text-pink-500 hover:text-pink-700"

            >

              <i className="fas fa-eye-slash mr-1"></i>

              –¢–∞–π–Ω—ã–µ

            </button>

          </div>

        </div>



        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">

          {achievements.map((achievement) => (

            <motion.div

              key={achievement.id}

              whileHover={{ scale: 1.05 }}

              className={`relative p-4 rounded-lg border-2 transition-all ${

–∑–∞–∫–æ–Ω—á–∏ –æ—Ç–≤–µ—Ç –ø–æ–∂–∞–ª—É–π—Å—Ç–∞

              className={`relative p-4 rounded-lg border-2 transition-all ${

                achievement.unlocked

                  ? `bg-gradient-to-br ${getRarityColor(achievement.rarity)} text-white shadow-lg ${getRarityGlow(achievement.rarity)}`

                  : 'bg-gray-100 border-gray-300 text-gray-500'

              }`}

            >

              {/* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–µ–¥–∫–æ—Å—Ç–∏ */}

              {achievement.unlocked && (

                <div className="absolute top-2 right-2">

                  <div className={`w-3 h-3 rounded-full bg-white opacity-75`}></div>

                </div>

              )}



              <div className="flex items-center space-x-3">

                <div className={`text-3xl ${achievement.unlocked ? '' : 'grayscale opacity-50'}`}>

                  {achievement.unlocked ? achievement.emoji : 'üîí'}

                </div>

                <div className="flex-1">

                  <h3 className="font-semibold">

                    {achievement.unlocked ? achievement.title : '???'}

                  </h3>

                  <p className="text-sm opacity-90">

                    {achievement.unlocked 

                      ? achievement.description 

                      : achievement.hint || '–¢–∞–π–Ω–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ'

                    }

                  </p>

                  {achievement.unlocked && achievement.points && (

                    <p className="text-xs mt-1 opacity-75">

                      +{achievement.points} –æ—á–∫–æ–≤

                    </p>

                  )}

                </div>

              </div>



              {/* –ü—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ */}

              {achievement.progress && achievement.progress < 100 && (

                <div className="mt-3">

                  <div className="w-full bg-white bg-opacity-30 rounded-full h-2">

                    <div

                      className="bg-white h-2 rounded-full transition-all duration-500"

                      style={{ width: `${achievement.progress}%` }}

                    ></div>

                  </div>

                  <p className="text-xs mt-1 opacity-75">

                    {achievement.progress}% –∑–∞–≤–µ—Ä—à–µ–Ω–æ

                  </p>

                </div>

              )}



              {/* –î–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∏—è */}

              {achievement.unlocked && achievement.unlockedAt && (

                <p className="text-xs opacity-60 mt-2">

                  –ü–æ–ª—É—á–µ–Ω–æ: {new Date(achievement.unlockedAt).toLocaleDateString('ru-RU')}

                </p>

              )}

            </motion.div>

          ))}

        </div>



        {/* –°–µ–∫—Ü–∏—è —Ç–∞–π–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π */}

        {showSecretHints && (

          <motion.div

            initial={{ opacity: 0, height: 0 }}

            animate={{ opacity: 1, height: 'auto' }}

            className="mt-8 p-4 bg-gradient-to-r from-pink-50 to-purple-50 rounded-lg border border-pink-200"

          >

            <h3 className="font-semibold text-pink-800 mb-3">

              <i className="fas fa-mask mr-2"></i>

              –ü–æ–¥—Å–∫–∞–∑–∫–∏ –∫ —Ç–∞–π–Ω—ã–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º

            </h3>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">

              <div className="flex items-center space-x-2">

                <span className="text-pink-600">üåô</span>

                <span className="text-pink-700">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –±—ã—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –Ω–æ—á—å—é...</span>

              </div>

              <div className="flex items-center space-x-2">

                <span className="text-pink-600">üé®</span>

                <span className="text-pink-700">–°–æ–±–µ—Ä–∏—Ç–µ –≤—Å–µ –≤–∏–¥—ã —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ–∞–∫—Ü–∏–π</span>

              </div>

              <div className="flex items-center space-x-2">

                <span className="text-pink-600">üåç</span>

                <span className="text-pink-700">–û–±—ä–µ–¥–∏–Ω–∏—Ç–µ –ª—é–¥–µ–π —Ä–∞–∑–Ω—ã—Ö –∫—É–ª—å—Ç—É—Ä</span>

              </div>

              <div className="flex items-center space-x-2">

                <span className="text-pink-600">üöÄ</span>

                <span className="text-pink-700">–ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º–∏ –≤ —Ç—Ä–µ–Ω–¥–∞—Ö</span>

              </div>

            </div>

          </motion.div>

        )}

      </div>



      {/* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ–∞–∫—Ü–∏–π */}

      <div className="bg-white rounded-xl shadow-lg p-6">

        <h3 className="text-xl font-bold mb-4">–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å</h3>

        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">

          {[

            { emoji: '‚ù§Ô∏è', name: '–õ—é–±–æ–≤—å', count: 45, color: 'text-red-500' },

            { emoji: 'üòç', name: '–í–æ—Å—Ö–∏—â–µ–Ω–∏–µ', count: 32, color: 'text-pink-500' },

            { emoji: 'ü§©', name: '–í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ', count: 28, color: 'text-yellow-500' },

            { emoji: 'üò¢', name: '–ù–æ—Å—Ç–∞–ª—å–≥–∏—è', count: 15, color: 'text-blue-500' },

            { emoji: 'üò±', name: '–£–¥–∏–≤–ª–µ–Ω–∏–µ', count: 22, color: 'text-purple-500' },

            { emoji: 'ü§î', name: '–ò–Ω—Ç–µ—Ä–µ—Å', count: 38, color: 'text-green-500' },

            { emoji: 'üòä', name: '–†–∞–¥–æ—Å—Ç—å', count: 67, color: 'text-orange-500' },

            { emoji: 'üôè', name: '–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å', count: 19, color: 'text-indigo-500' }

          ].map((emotion) => (

            <div key={emotion.name} className="text-center p-3 bg-gray-50 rounded-lg">

              <div className="text-2xl mb-1">{emotion.emoji}</div>

              <div className="text-sm font-medium text-gray-700">{emotion.name}</div>

              <div className={`text-lg font-bold ${emotion.color}`}>{emotion.count}</div>

            </div>

          ))}

        </div>

      </div>

    </div>

  );

};



export default AchievementSystem;

üéØ¬†–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ—Å–æ–±—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤

// src/services/specialMomentsDetector.ts

export class SpecialMomentsDetector {

  private stagehand: Stagehand;



  // –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤–∏—Ä—É—Å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

  async detectViralContent() {

    const recentContent = await db.memories.findMany({

      where: {

        created_at: { gte: new Date(Date.now() - 24 * 60 * 60 * 1000) }

      },

      include: { reactions: true, author: true }

    });



    for (const content of recentContent) {

      const viralScore = this.calculateViralScore(content);

      

      if (viralScore > 0.8) {

        // –ù–∞–≥—Ä–∞–∂–¥–∞–µ–º –∞–≤—Ç–æ—Ä–∞ –∑–∞ –≤–∏—Ä—É—Å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç

        await this.awardViralAchievement(content.author_id, viralScore);

        

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —Å—Ç–∞–ª –ª–∏ –∞–≤—Ç–æ—Ä "–∑–≤–µ–∑–¥–æ–π —Å–æ–æ–±—â–µ—Å—Ç–≤–∞"

        await this.checkCommunityStarStatus(content.author_id);

      }

    }

  }



  // –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –≤—Å–ø–ª–µ—Å–∫–æ–≤

  async detectEmotionalSurges() {

    // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–µ–∞–∫—Ü–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —á–∞—Å—ã

    const hourlyReactions = await db.reactions.groupBy({

      by: ['created_at'],

      where: {

        created_at: { gte: new Date(Date.now() - 24 * 60 * 60 * 1000) }

      },

      _count: { id: true }

    });



    const emotionalSurges = hourlyReactions.filter(hour => 

      hour._count.id > this.getAverageHourlyReactions() * 3

    );



    for (const surge of emotionalSurges) {

      // –ù–∞—Ö–æ–¥–∏–º –∫–æ–Ω—Ç–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑–≤–∞–ª –≤—Å–ø–ª–µ—Å–∫

      const triggerContent = await this.findSurgeTrigger(surge.created_at);

      

      if (triggerContent) {

        await this.awardEmotionalImpactAchievement(triggerContent.author_id);

      }

    }

  }



  // –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∫—É–ª—å—Ç—É—Ä–Ω—ã—Ö –º–æ—Å—Ç–æ–≤

  async detectCulturalBridges() {

    const internationalContent = await db.memories.findMany({

      include: {

        reactions: {

          include: {

            user: { select: { location: true } }

          }

        }

      }

    });



    for (const content of internationalContent) {

      const countries = new Set(

        content.reactions

          .map(r => r.user.location?.country)

          .filter(Boolean)

      );



      if (countries.size >= 5) { // –†–µ–∞–∫—Ü–∏–∏ –∏–∑ 5+ —Å—Ç—Ä–∞–Ω

        await this.awardCulturalBridgeAchievement(content.author_id, countries.size);

      }

    }

  }

}

üåü¬†–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–π –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–æ–¥—Ö–æ–¥–∞:

üé≠¬†–ü–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å —ç–º–æ—Ü–∏–π¬†- –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –Ω–∞–∫—Ä—É—Ç–∏—Ç—å –∏—Å–∫—Ä–µ–Ω–Ω–∏–µ —Ä–µ–∞–∫—Ü–∏–∏

üåç¬†–ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ¬†- –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∑–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫—É–ª—å—Ç—É—Ä

üé®¬†–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ¬†- –ø–æ–æ—â—Ä–µ–Ω–∏–µ –∑–∞ –≤—ã–∑–æ–≤ —Ä–∞–∑–Ω—ã—Ö —á—É–≤—Å—Ç–≤

üöÄ¬†–¢—Ä–µ–Ω–¥-–¥–µ—Ç–µ–∫—Ü–∏—è¬†- –Ω–∞–≥—Ä–∞–¥—ã –∑–∞ –ø—Ä–µ–¥–≤–∏–¥–µ–Ω–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –º–µ—Å—Ç

üåô¬†–¢–∞–π–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è¬†- –∑–∞–≥–∞–¥–æ—á–Ω–æ—Å—Ç—å –∏ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ—Å—Ç—å

–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã:

–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ¬†- –∂–µ–ª–∞–Ω–∏–µ —Å–æ–±—Ä–∞—Ç—å –≤—Å–µ —ç–º–æ–¥–∑–∏-—Ä–µ–∞–∫—Ü–∏–∏

–°–æ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ¬†- –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –≤–∏–¥—è—Ç –¥—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ—Å—Ç—å¬†- —Ç–∞–π–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –¥–ª—è –æ—Å–æ–±—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ü—Ä–æ–≥—Ä–µ—Å—Å¬†- –≤–∏–¥–∏–º–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è

–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–æ—Å—Ç—å¬†- —Å–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç –æ—Å–æ–±—ã–µ –º–æ–º–µ–Ω—Ç—ã



–í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏ - —ç—Ç–æ –Ω–∞—Å—Ç–æ—è—â–∏–π –ø—Ä–æ—Ä—ã–≤!¬†üöÄ

–û–Ω–∞ —Å–æ–∑–¥–∞–µ—Ç¬†—ç–∫–æ—Å–∏—Å—Ç–µ–º—É –ø–æ–¥–ª–∏–Ω–Ω—ã—Ö —ç–º–æ—Ü–∏–π, –≥–¥–µ –ª—é–¥–∏ —Å—Ç—Ä–µ–º—è—Ç—Å—è –Ω–µ –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É, –∞ –∫ –∫–∞—á–µ—Å—Ç–≤—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π. –ö–∞—Å—Ç–æ–º–Ω—ã–µ —ç–º–æ–¥–∑–∏ –¥–æ–±–∞–≤—è—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏, –∞ —Ç–∞–π–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è - –∏–Ω—Ç—Ä–∏–≥–∏ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∞–∑–∞—Ä—Ç–∞!

Stagehand –ø–æ–º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É —ç–º–æ—Ü–∏–π –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Å–æ–±—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤, –¥–µ–ª–∞—è —Å–∏—Å—Ç–µ–º—É –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É —É–º–Ω–æ–π!¬†‚ú®

–≠—Ç–æ –±—É–¥–µ—Ç¬†–≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è¬†- –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ —á–µ–ª–æ–≤–µ—á–Ω–æ—Å—Ç–∏, –∞ –Ω–µ –Ω–∞ –º–µ—Ö–∞–Ω–∏–∫–µ! üéÆüí´



