# ü§ñ –°–ò–°–¢–ï–ú–ê –ü–û–õ–£–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ô –ú–û–î–ï–†–ê–¶–ò–ò –° –ò–ò-–ü–û–ú–û–©–ù–ò–ö–û–ú

## üéØ –ö–û–ù–¶–ï–ü–¶–ò–Ø

**–ò–ò-–ø–æ–º–æ—â–Ω–∏–∫** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–µ—Å—å —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ (–æ–¥–æ–±—Ä–∏—Ç—å/–æ—Ç–∫–ª–æ–Ω–∏—Ç—å/—Å–∫—Ä—ã—Ç—å).

**–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É –ò–ò –∏ —Å—Ç–∞–≤–∏—Ç –≤–µ—Ä–¥–∏–∫—Ç:
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ** - —Ä–µ—à–µ–Ω–∏–µ –ò–ò –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ** - –∞–¥–º–∏–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –Ω–µ —Ç–∞–∫, –ò–ò —É—á–∏—Ç—Å—è –Ω–∞ –æ—à–∏–±–∫–∞—Ö

## üìä –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ª—é–±–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—Å–æ–±—ã—Ç–∏—è, –ø–æ—Å—Ç—ã, –º–∞—Ä—à—Ä—É—Ç—ã –∏ —Ç.–¥.)
- –ò–ò –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç
- –†–µ—à–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `ai_moderation_decisions`
- –°—Ç–∞—Ç—É—Å: `admin_verdict = 'pending'` (–æ–∂–∏–¥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–¥–º–∏–Ω–∞)

### 2. –ü–∞–Ω–µ–ª—å –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –ò–ò
- –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç –≤—Å–µ —Ä–µ—à–µ–Ω–∏—è –ò–ò —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending`
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:
  - –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ò–ò (–æ–¥–æ–±—Ä–∏—Ç—å/–æ—Ç–∫–ª–æ–Ω–∏—Ç—å/—Å–∫—Ä—ã—Ç—å)
  - –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ò–ò (0-100%)
  - –ö–∞—Ç–µ–≥–æ—Ä–∏—è (—Å–ø–∞–º/–Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏–π/—Ñ–µ–π–∫/–±–µ–∑–æ–ø–∞—Å–Ω—ã–π)
  - –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
  - –°–∞–º –∫–æ–Ω—Ç–µ–Ω—Ç

### 3. –í–µ—Ä–¥–∏–∫—Ç –∞–¥–º–∏–Ω–∞
- **–ü—Ä–∞–≤–∏–ª—å–Ω–æ** ‚Üí –†–µ—à–µ–Ω–∏–µ –ò–ò –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ** ‚Üí –ê–¥–º–∏–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏—á–∏–Ω—É, –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –ò–ò

### 4. –û–±—É—á–µ–Ω–∏–µ –ò–ò
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `ai_moderation_training`
- –í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –ò–ò

## üóÑÔ∏è –°–¢–†–£–ö–¢–£–†–ê –ë–î

### –¢–∞–±–ª–∏—Ü–∞ `ai_moderation_decisions`
- `id` - UUID
- `content_type` - —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (events, posts, routes, markers, blogs, comments, chats)
- `content_id` - ID –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- `ai_suggestion` - –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ò–ò (approve, reject, hide, review)
- `ai_confidence` - —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ò–ò (0-1)
- `ai_reason` - –ø—Ä–∏—á–∏–Ω–∞ —Ä–µ—à–µ–Ω–∏—è
- `ai_category` - –∫–∞—Ç–µ–≥–æ—Ä–∏—è (spam, inappropriate, fake, safe)
- `ai_issues` - –º–∞—Å—Å–∏–≤ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
- `admin_verdict` - –≤–µ—Ä–¥–∏–∫—Ç –∞–¥–º–∏–Ω–∞ (correct, incorrect, pending)
- `admin_feedback` - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∞–¥–º–∏–Ω–∞
- `admin_id` - ID –∞–¥–º–∏–Ω–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä–∏–ª
- `reviewed_at` - –¥–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
- `created_at`, `updated_at` - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏

### –¢–∞–±–ª–∏—Ü–∞ `ai_moderation_training`
- `id` - UUID
- `decision_id` - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ
- `content_text` - —Ç–µ–∫—Å—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- `content_type` - —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- `ai_suggestion` - —á—Ç–æ –ø—Ä–µ–¥–ª–æ–∂–∏–ª –ò–ò
- `admin_verdict` - –≤–µ—Ä–¥–∏–∫—Ç –∞–¥–º–∏–Ω–∞
- `admin_feedback` - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∞–¥–º–∏–Ω–∞
- `learned_at` - –¥–∞—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

## üîå API ENDPOINTS

### –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (–ò–ò —É–∂–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª)
```
GET /api/moderation/ai/:contentType/review
```
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –ò–ò —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending`

### –ò–ò –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç (–≤—Ä—É—á–Ω—É—é, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
```
POST /api/moderation/ai/:contentType/:contentId/analyze
```
–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### –ê–¥–º–∏–Ω —Å—Ç–∞–≤–∏—Ç –≤–µ—Ä–¥–∏–∫—Ç
```
POST /api/moderation/ai/decisions/:decisionId/verdict
Body: {
  "verdict": "correct" | "incorrect",
  "feedback": "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø—Ä–∏ incorrect)"
}
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –ò–ò
```
GET /api/moderation/ai/stats
```
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤–µ—Ä–¥–∏–∫—Ç–∞–º (correct/incorrect/pending)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ç–∏–ø–∞–º –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –¢–æ—á–Ω–æ—Å—Ç—å –ò–ò (%)

## üé® –ò–ù–¢–ï–†–§–ï–ô–°

### –í–∫–ª–∞–¥–∫–∞ "–ò–ò-–ø–æ–º–æ—â–Ω–∏–∫" –≤ ModerationPanel
1. –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—Å–æ–±—ã—Ç–∏—è, –ø–æ—Å—Ç—ã, –º–∞—Ä—à—Ä—É—Ç—ã –∏ —Ç.–¥.)
2. –°–ø–∏—Å–æ–∫ —Ä–µ—à–µ–Ω–∏–π –ò–ò, –æ–∂–∏–¥–∞—é—â–∏—Ö –ø—Ä–æ–≤–µ—Ä–∫–∏
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è:
   - –ö–∞—Ä—Ç–æ—á–∫–∞ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –ò–ò
   - –ö–Ω–æ–ø–∫–∏ "–ü—Ä–∞–≤–∏–ª—å–Ω–æ" / "–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ"
   - –ü—Ä–∏ "–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ" - –ø–æ–ª–µ –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è

### –í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:
- üü¢ –ó–µ–ª–µ–Ω—ã–π - –ò–ò –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –æ–¥–æ–±—Ä–∏—Ç—å
- üî¥ –ö—Ä–∞—Å–Ω—ã–π - –ò–ò –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –æ—Ç–∫–ª–æ–Ω–∏—Ç—å
- üü° –ñ–µ–ª—Ç—ã–π - –ò–ò –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Å–∫—Ä—ã—Ç—å
- üîµ –°–∏–Ω–∏–π - –ò–ò –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É

## üîÑ –ü–†–û–¶–ï–°–° –†–ê–ë–û–¢–´

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ
  ‚Üì
–°–æ–±—ã—Ç–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 'pending'
  ‚Üì
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è autoAnalyzeContent()
  ‚Üì
–ò–ò –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç
  ‚Üì
–†–µ—à–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ ai_moderation_decisions
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–æ–º
```
–ê–¥–º–∏–Ω –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–∞–Ω–µ–ª—å "–ò–ò-–ø–æ–º–æ—â–Ω–∏–∫"
  ‚Üì
–í–∏–¥–∏—Ç —Å–ø–∏—Å–æ–∫ —Ä–µ—à–µ–Ω–∏–π –ò–ò
  ‚Üì
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥–æ–µ —Ä–µ—à–µ–Ω–∏–µ
  ‚Üì
–°—Ç–∞–≤–∏—Ç –≤–µ—Ä–¥–∏–∫—Ç: –ü—Ä–∞–≤–∏–ª—å–Ω–æ / –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
  ‚Üì
–ï—Å–ª–∏ "–ü—Ä–∞–≤–∏–ª—å–Ω–æ" ‚Üí –†–µ—à–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
–ï—Å–ª–∏ "–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ" ‚Üí –£–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏—á–∏–Ω—É, –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
```

## üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò –û–ë–£–ß–ï–ù–ò–ï

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –ò–ò:
- –°–∫–æ–ª—å–∫–æ —Ä–µ—à–µ–Ω–∏–π –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ
- –°–∫–æ–ª—å–∫–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö
- –¢–æ—á–Ω–æ—Å—Ç—å –ò–ò (%)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### –û–±—É—á–µ–Ω–∏–µ:
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `ai_moderation_training`
- –ú–æ–∂–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –æ—à–∏–±–æ–∫
- –í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

## üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢

### 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é:
```bash
cd backend
node -e "
import pool from './db.js';
import fs from 'fs';
const sql = fs.readFileSync('src/migrations/add-ai-moderation-system.sql', 'utf8');
const client = await pool.connect();
try {
  await client.query(sql);
  console.log('‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞');
} finally {
  client.release();
  await pool.end();
}
"
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É:
- –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –æ–Ω–æ –ø–æ—è–≤–∏–ª–æ—Å—å –≤ –ø–∞–Ω–µ–ª–∏ "–ò–ò-–ø–æ–º–æ—â–Ω–∏–∫"
- –ü–æ—Å—Ç–∞–≤–∏—Ç—å –≤–µ—Ä–¥–∏–∫—Ç

## üìù –ó–ê–ú–ï–¢–ö–ò

- –ò–ò –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
- –ê–¥–º–∏–Ω —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É –ò–ò, –Ω–µ –º–æ–¥–µ—Ä–∏—Ä—É–µ—Ç –≤—Ä—É—á–Ω—É—é
- –í—Å–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
- –°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ª—É—á—à–∞—Ç—å –ò–ò –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏

