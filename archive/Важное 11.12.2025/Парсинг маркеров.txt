–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —É –º–µ–Ω—è –µ—Å—Ç—å –≤—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è. –°–æ–∑–¥–∞–º –¥–ª—è –≤–∞—Å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç.

üöÄ –ü–∞—Ä—Å–∏–Ω–≥–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç WayAtom
üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É wayatom-parser –≤ –∫–æ—Ä–Ω–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

wayatom-parser/
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ cities.js
‚îÇ   ‚îú‚îÄ‚îÄ categories.js
‚îÇ   ‚îî‚îÄ‚îÄ database.js
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ overpassService.js
‚îÇ   ‚îú‚îÄ‚îÄ wikipediaService.js
‚îÇ   ‚îî‚îÄ‚îÄ databaseService.js
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ logger.js
‚îÇ   ‚îî‚îÄ‚îÄ validator.js
‚îú‚îÄ‚îÄ parsers/
‚îÇ   ‚îî‚îÄ‚îÄ cityParser.js
‚îú‚îÄ‚îÄ progress/
‚îÇ   ‚îî‚îÄ‚îÄ cities-progress.json
‚îî‚îÄ‚îÄ index.js
üì¶ package.json
{
  "name": "wayatom-parser",
  "version": "1.0.0",
  "description": "–ü–∞—Ä—Å–µ—Ä –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç—ã WayAtom –º–µ—Ç–∫–∞–º–∏ –∏–∑ OpenStreetMap –∏ Wikipedia",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "parse": "node index.js --city",
    "progress": "node utils/progress.js"
  },
  "dependencies": {
    "axios": "^1.6.0",
    "pg": "^8.11.0",
    "dotenv": "^16.3.1",
    "chalk": "^4.1.2",
    "inquirer": "^8.2.6",
    "uuid": "^9.0.1"
  },
  "devDependencies": {
    "nodemon": "^3.0.1"
  }
}
üîß .env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
DB_HOST=localhost
DB_PORT=5432
DB_NAME=wayatom
DB_USER=your_username
DB_PASSWORD=your_password

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä—Å–µ—Ä–∞
BATCH_SIZE=50
DELAY_BETWEEN_REQUESTS=1000
MAX_RETRIES=3

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL=info
üèôÔ∏è config/cities.js
module.exports = {
  // –ö—Ä—É–ø–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –†–æ—Å—Å–∏–∏
  moscow: {
    name: '–ú–æ—Å–∫–≤–∞',
    bounds: [55.4922, 37.3193, 55.9579, 37.9678],
    priority: 1
  },
  spb: {
    name: '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',
    bounds: [59.7342, 30.0395, 60.0943, 30.5804],
    priority: 1
  },
  kazan: {
    name: '–ö–∞–∑–∞–Ω—å',
    bounds: [55.6967, 49.0089, 55.8963, 49.2847],
    priority: 2
  },
  novosibirsk: {
    name: '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫',
    bounds: [54.9022, 82.7606, 55.1838, 83.1280],
    priority: 2
  },
  ekaterinburg: {
    name: '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥',
    bounds: [56.7104, 60.4231, 56.9439, 60.7317],
    priority: 2
  },
  nizhny: {
    name: '–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥',
    bounds: [56.1965, 43.7840, 56.3968, 44.1341],
    priority: 2
  },
  samara: {
    name: '–°–∞–º–∞—Ä–∞',
    bounds: [53.1479, 50.0334, 53.2785, 50.3446],
    priority: 3
  },
  omsk: {
    name: '–û–º—Å–∫',
    bounds: [54.8661, 73.2458, 55.0561, 73.4658],
    priority: 3
  },
  rostov: {
    name: '–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É',
    bounds: [47.1692, 39.5991, 47.3092, 39.8191],
    priority: 3
  },
  ufa: {
    name: '–£—Ñ–∞',
    bounds: [54.6269, 55.8569, 54.8469, 56.1769],
    priority: 3
  },
  krasnoyarsk: {
    name: '–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫',
    bounds: [55.9289, 92.7289, 56.1089, 93.0089],
    priority: 3
  },
  vladimir: {
    name: '–í–ª–∞–¥–∏–º–∏—Ä',
    bounds: [56.0784, 40.3284, 56.1784, 40.4484],
    priority: 4
  },
  suzdal: {
    name: '–°—É–∑–¥–∞–ª—å',
    bounds: [56.4084, 40.4284, 56.4384, 40.4584],
    priority: 4
  },
  yaroslavl: {
    name: '–Ø—Ä–æ—Å–ª–∞–≤–ª—å',
    bounds: [57.5584, 39.8284, 57.6584, 39.9484],
    priority: 4
  },
  tula: {
    name: '–¢—É–ª–∞',
    bounds: [54.1584, 37.5784, 54.2584, 37.6984],
    priority: 4
  },
  kaluga: {
    name: '–ö–∞–ª—É–≥–∞',
    bounds: [54.4984, 36.2284, 54.5984, 36.3484],
    priority: 4
  }
};
üè∑Ô∏è config/categories.js
module.exports = {
  attractions: {
    name: '–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏',
    overpass_query: `
      [out:json][timeout:25];
      (
        way["tourism"="attraction"]({{bbox}});
        node["tourism"="attraction"]({{bbox}});
        way["historic"]({{bbox}});
        node["historic"]({{bbox}});
        way["tourism"="viewpoint"]({{bbox}});
        node["tourism"="viewpoint"]({{bbox}});
      );
      out center meta;
    `,
    subcategories: ['–ø–∞–º—è—Ç–Ω–∏–∫', '–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞', '—Å–º–æ—Ç—Ä–æ–≤–∞—è –ø–ª–æ—â–∞–¥–∫–∞', '–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –º–µ—Å—Ç–æ']
  },
  
  museums: {
    name: '–ú—É–∑–µ–∏',
    overpass_query: `
      [out:json][timeout:25];
      (
        way["tourism"="museum"]({{bbox}});
        node["tourism"="museum"]({{bbox}});
        way["amenity"="arts_centre"]({{bbox}});
        node["amenity"="arts_centre"]({{bbox}});
      );
      out center meta;
    `,
    subcategories: ['—Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –º—É–∑–µ–π', '–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –º—É–∑–µ–π', '–Ω–∞—É—á–Ω—ã–π –º—É–∑–µ–π', '–≥–∞–ª–µ—Ä–µ—è']
  },
  
  restaurants: {
    name: '–†–µ—Å—Ç–æ—Ä–∞–Ω—ã',
    overpass_query: `
      [out:json][timeout:25];
      (
        way["amenity"="restaurant"]({{bbox}});
        node["amenity"="restaurant"]({{bbox}});
        way["amenity"="cafe"]({{bbox}});
        node["amenity"="cafe"]({{bbox}});
        way["amenity"="fast_food"]({{bbox}});
        node["amenity"="fast_food"]({{bbox}});
      );
      out center meta;
    `,
    subcategories: ['—Ä–µ—Å—Ç–æ—Ä–∞–Ω', '–∫–∞—Ñ–µ', '–±—ã—Å—Ç—Ä–æ–µ –ø–∏—Ç–∞–Ω–∏–µ', '–±–∞—Ä']
  },
  
  hotels: {
    name: '–û—Ç–µ–ª–∏',
    overpass_query: `
      [out:json][timeout:25];
      (
        way["tourism"="hotel"]({{bbox}});
        node["tourism"="hotel"]({{bbox}});
        way["tourism"="hostel"]({{bbox}});
        node["tourism"="hostel"]({{bbox}});
        way["tourism"="guest_house"]({{bbox}});
        node["tourism"="guest_house"]({{bbox}});
      );
      out center meta;
    `,
    subcategories: ['–æ—Ç–µ–ª—å', '—Ö–æ—Å—Ç–µ–ª', '–≥–æ—Å—Ç–µ–≤–æ–π –¥–æ–º', '–≥–æ—Å—Ç–∏–Ω–∏—Ü–∞']
  },
  
  parks: {
    name: '–ü–∞—Ä–∫–∏',
    overpass_query: `
      [out:json][timeout:25];
      (
        way["leisure"="park"]({{bbox}});
        node["leisure"="park"]({{bbox}});
        way["leisure"="garden"]({{bbox}});
        node["leisure"="garden"]({{bbox}});
        way["natural"="forest"]({{bbox}});
        node["natural"="forest"]({{bbox}});
      );
      out center meta;
    `,
    subcategories: ['–≥–æ—Ä–æ–¥—Å–∫–æ–π –ø–∞—Ä–∫', '—Å–∞–¥', '–ª–µ—Å', '—Å–∫–≤–µ—Ä']
  }
};
üóÑÔ∏è config/database.js
const { Pool } = require('pg');
require('dotenv').config();

const pool = new Pool({
  host: process.env.DB_HOST,
  port: process.env.DB_PORT,
  database: process.env.DB_NAME,
  user: process.env.DB_USER,
  password: process.env.DB_PASSWORD,
});

module.exports = pool;
üåê services/overpassService.js
const axios = require('axios');
const logger = require('../utils/logger');

class OverpassService {
  constructor() {
    this.baseUrl = 'https://overpass-api.de/api/interpreter';
    this.timeout = 30000;
  }

  async queryPOIs(category, bounds) {
    try {
      const [south, west, north, east] = bounds;
      const bbox = `${south},${west},${north},${east}`;
      
      const query = category.overpass_query.replace('{{bbox}}', bbox);
      
      logger.info(`–ó–∞–ø—Ä–æ—Å –∫ Overpass API –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: ${category.name}`);
      
      const response = await axios.post(this.baseUrl, query, {
        timeout: this.timeout,
        headers: {
          'Content-Type': 'text/plain; charset=utf-8'
        }
      });

      const elements = response.data.elements || [];
      logger.info(`–ü–æ–ª—É—á–µ–Ω–æ ${elements.length} –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ${category.name}`);
      
      return this.processElements(elements);
    } catch (error) {
      logger.error(`–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ Overpass API: ${error.message}`);
      return [];
    }
  }

  processElements(elements) {
    return elements.map(element => {
      let lat, lon;
      
      if (element.type === 'node') {
        lat = element.lat;
        lon = element.lon;
      } else if (element.center) {
        lat = element.center.lat;
        lon = element.center.lon;
      } else {
        return null;
      }

      const tags = element.tags || {};
      
      return {
        osm_id: element.id,
        osm_type: element.type,
        name: tags.name || tags['name:ru'] || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è',
        latitude: lat,
        longitude: lon,
        tags: tags,
        address: this.buildAddress(tags)
      };
    }).filter(Boolean);
  }

  buildAddress(tags) {
    const parts = [];
    
    if (tags['addr:street']) parts.push(`—É–ª. ${tags['addr:street']}`);
    if (tags['addr:housenumber']) parts.push(tags['addr:housenumber']);
    if (tags['addr:city']) parts.push(tags['addr:city']);
    
    return parts.length > 0 ? parts.join(', ') : null;
  }
}

module.exports = new OverpassService();
üìö services/wikipediaService.js
const axios = require('axios');
const logger = require('../utils/logger');

class WikipediaService {
  constructor() {
    this.baseUrl = 'https://ru.wikipedia.org/api/rest_v1';
    this.searchUrl = 'https://ru.wikipedia.org/w/api.php';
  }

  async getDescription(title, cityName) {
    try {
      // –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º —Å—Ç–∞—Ç—å—é
      const searchResults = await this.searchArticle(title, cityName);
      
      if (!searchResults || searchResults.length === 0) {
        return this.generateFallbackDescription(title);
      }

      // –ü–æ–ª—É—á–∞–µ–º –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
      const pageTitle = searchResults[0];
      const summary = await this.getPageSummary(pageTitle);
      
      return summary || this.generateFallbackDescription(title);
    } catch (error) {
      logger.warn(`–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è "${title}": ${error.message}`);
      return this.generateFallbackDescription(title);
    }
  }

  async searchArticle(title, cityName) {
    try {
      const searchQueries = [
        `${title} ${cityName}`,
        title,
        `${title} –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å`,
        `${title} –º—É–∑–µ–π`,
        `${title} —Ä–µ—Å—Ç–æ—Ä–∞–Ω`
      ];

      for (const query of searchQueries) {
        const response = await axios.get(this.searchUrl, {
          params: {
            action: 'query',
            format: 'json',
            list: 'search',
            srsearch: query,
            srlimit: 3
          },
          timeout: 10000
        });

        const results = response.data.query?.search || [];
        if (results.length > 0) {
          return results.map(r => r.title);
        }
      }

      return [];
    } catch (error) {
      logger.warn(`–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –≤ Wikipedia: ${error.message}`);
      return [];
    }
  }

  async getPageSummary(pageTitle) {
    try {
      const response = await axios.get(`${this.baseUrl}/page/summary/${encodeURIComponent(pageTitle)}`, {
        timeout: 10000
      });

      const extract = response.data.extract;
      
      if (extract && extract.length > 50) {
        // –û–±—Ä–µ–∑–∞–µ–º –¥–æ —Ä–∞–∑—É–º–Ω–æ–π –¥–ª–∏–Ω—ã
        return extract.length > 300 ? extract.substring(0, 297) + '...' : extract;
      }

      return null;
    } catch (error) {
      logger.warn(`–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã: ${error.message}`);
      return null;
    }
  }

  generateFallbackDescription(title) {
    const templates = [
      `${title} - –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –º–µ—Å—Ç–æ, –∫–æ—Ç–æ—Ä–æ–µ —Å—Ç–æ–∏—Ç –ø–æ—Å–µ—Ç–∏—Ç—å.`,
      `${title} - –æ–¥–Ω–æ –∏–∑ –ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Å—Ç –≤ –≥–æ—Ä–æ–¥–µ.`,
      `${title} - –º–µ—Å—Ç–æ —Å –±–æ–≥–∞—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π –∏ –∫—É–ª—å—Ç—É—Ä–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.`,
      `${title} - –ø–æ–ø—É–ª—è—Ä–Ω–æ–µ –º–µ—Å—Ç–æ —Å—Ä–µ–¥–∏ –∂–∏—Ç–µ–ª–µ–π –∏ —Ç—É—Ä–∏—Å—Ç–æ–≤.`,
      `${title} - –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∏ –ø–æ—Å–µ—â–µ–Ω–∏–∏ –≥–æ—Ä–æ–¥–∞.`
    ];
    
    return templates[Math.floor(Math.random() * templates.length)];
  }
}

module.exports = new WikipediaService();
üóÑÔ∏è services/databaseService.js
const pool = require('../config/database');
const { v4: uuidv4 } = require('uuid');
const logger = require('../utils/logger');

class DatabaseService {
  async insertMarker(markerData) {
    const client = await pool.connect();
    
    try {
      const query = `
        INSERT INTO markers (
          id, title, description, latitude, longitude, address,
          category, subcategory, author_name, hashtags, 
          is_verified, is_active, visibility, marker_type,
          rating, rating_count, views_count, likes_count, 
          comments_count, shares_count, photo_urls, metadata
        ) VALUES (
          $1, $2, $3, $4, $5, $6, $7, $8, $9, $10,
          $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22
        ) RETURNING id;
      `;

      const values = [
        uuidv4(), // id
        markerData.title,
        markerData.description,
        markerData.latitude,
        markerData.longitude,
        markerData.address,
        markerData.category,
        markerData.subcategory,
        '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', // author_name
        markerData.hashtags || [],
        true, // is_verified
        true, // is_active
        'public', // visibility
        'standard', // marker_type
        0, // rating
        0, // rating_count
        0, // views_count
        0, // likes_count
        0, // comments_count
        0, // shares_count
        [], // photo_urls
        markerData.metadata || {}
      ];

      const result = await client.query(query, values);
      logger.info(`–î–æ–±–∞–≤–ª–µ–Ω –º–∞—Ä–∫–µ—Ä: ${markerData.title}`);
      
      return result.rows[0].id;
    } catch (error) {
      if (error.code === '23505') { // Duplicate key
        logger.warn(`–ú–∞—Ä–∫–µ—Ä —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: ${markerData.title}`);
        return null;
      }
      
      logger.error(`–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ä–∞: ${error.message}`);
      throw error;
    } finally {
      client.release();
    }
  }

  async checkMarkerExists(title, latitude, longitude) {
    try {
      const query = `
        SELECT id FROM markers 
        WHERE title = $1 
        AND ABS(latitude - $2) < 0.001 
        AND ABS(longitude - $3) < 0.001
        LIMIT 1;
      `;
      
      const result = await pool.query(query, [title, latitude, longitude]);
      return result.rows.length > 0;
    } catch (error) {
      logger.error(`–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –º–∞—Ä–∫–µ—Ä–∞: ${error.message}`);
      return false;
    }
  }

  async getMarkersCount() {
    try {
      const result = await pool.query('SELECT COUNT(*) as count FROM markers');
      return parseInt(result.rows[0].count);
    } catch (error) {
      logger.error(`–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∞—Ä–∫–µ—Ä–æ–≤: ${error.message}`);
      return 0;
    }
  }
}

module.exports = new DatabaseService();
üìù utils/logger.js
const chalk = require('chalk');

class Logger {
  info(message) {
    console.log(chalk.blue(`[INFO] ${new Date().toISOString()} - ${message}`));
  }

  warn(message) {
    console.log(chalk.yellow(`[WARN] ${new Date().toISOString()} - ${message}`));
  }

  error(message) {
    console.log(chalk.red(`[ERROR] ${new Date().toISOString()} - ${message}`));
  }

  success(message) {
    console.log(chalk.green(`[SUCCESS] ${new Date().toISOString()} - ${message}`));
  }
}

module.exports = new Logger();
‚úÖ utils/validator.js
class Validator {
  static isValidCoordinate(lat, lon) {
    return (
      typeof lat === 'number' && 
      typeof lon === 'number' &&
      lat >= -90 && lat <= 90 &&
      lon >= -180 && lon <= 180
    );
  }

  static isValidTitle(title) {
    return typeof title === 'string' && title.trim().length > 0;
  }

  static sanitizeTitle(title) {
    return title.trim().replace(/\s+/g, ' ');
  }

  static generateHashtags(title, category, cityName) {
    const hashtags = [];
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≥–æ—Ä–æ–¥
    hashtags.push(cityName.toLowerCase().replace(/\s+/g, ''));
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
    hashtags.push(category.toLowerCase());
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è
    const words = title.toLowerCase().split(/\s+/)
      .filter(word => word.length > 3)
      .slice(0, 2);
    
    hashtags.push(...words);
    
    return [...new Set(hashtags)]; // –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
  }
}

module.exports = Validator;
üèôÔ∏è parsers/cityParser.js
const overpassService = require('../services/overpassService');
const wikipediaService = require('../services/wikipediaService');
const databaseService = require('../services/databaseService');
const validator = require('../utils/validator');
const logger = require('../utils/logger');
const categories = require('../config/categories');

class CityParser {
  constructor() {
    this.delay = parseInt(process.env.DELAY_BETWEEN_REQUESTS) || 1000;
    this.batchSize = parseInt(process.env.BATCH_SIZE) || 50;
  }

  async parseCity(cityConfig) {
    logger.info(`üèôÔ∏è –ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä—Å–∏–Ω–≥ –≥–æ—Ä–æ–¥–∞: ${cityConfig.name}`);
    
    let totalAdded = 0;
    
    for (const [categoryKey, category] of Object.entries(categories)) {
      logger.info(`üìÇ –ü–∞—Ä—Å–∏–Ω–≥ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: ${category.name}`);
      
      try {
        const pois = await overpassService.queryPOIs(category, cityConfig.bounds);
        logger.info(`–ù–∞–π–¥–µ–Ω–æ ${pois.length} –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ${category.name}`);
        
        const processed = await this.processPOIs(pois, category, cityConfig.name);
        totalAdded += processed;
        
        // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        await this.sleep(this.delay);
        
      } catch (error) {
        logger.error(`–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ${category.name}: ${error.message}`);
      }
    }
    
    logger.success(`‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –≥–æ—Ä–æ–¥–∞ ${cityConfig.name} –∑–∞–≤–µ—Ä—à–µ–Ω. –î–æ–±–∞–≤–ª–µ–Ω–æ: ${totalAdded} –º–∞—Ä–∫–µ—Ä–æ–≤`);
    return totalAdded;
  }

  async processPOIs(pois, category, cityName) {
    let addedCount = 0;
    
    for (let i = 0; i < pois.length; i += this.batchSize) {
      const batch = pois.slice(i, i + this.batchSize);
      
      for (const poi of batch) {
        try {
          if (!validator.isValidCoordinate(poi.latitude, poi.longitude)) {
            continue;
          }

          if (!validator.isValidTitle(poi.name)) {
            continue;
          }

          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–π –º–∞—Ä–∫–µ—Ä
          const exists = await databaseService.checkMarkerExists(
            poi.name, 
            poi.latitude, 
            poi.longitude
          );

          if (exists) {
            continue;
          }

          // –ü–æ–ª—É—á–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑ Wikipedia
          const description = await wikipediaService.getDescription(poi.name, cityName);
          
          // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –º–∞—Ä–∫–µ—Ä–∞
          const markerData = {
            title: validator.sanitizeTitle(poi.name),
            description: description,
            latitude: poi.latitude,
            longitude: poi.longitude,
            address: poi.address,
            category: category.name,
            subcategory: this.selectSubcategory(poi.tags, category.subcategories),
            hashtags: validator.generateHashtags(poi.name, category.name, cityName),
            metadata: {
              osm_id: poi.osm_id,
              osm_type: poi.osm_type,
              source: 'openstreetmap',
              parsed_at: new Date().toISOString()
            }
          };

          // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
          const markerId = await databaseService.insertMarker(markerData);
          
          if (markerId) {
            addedCount++;
            logger.info(`‚ûï –î–æ–±–∞–≤–ª–µ–Ω: ${poi.name}`);
          }

          // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
          await this.sleep(this.delay / 2);
          
        } catch (error) {
          logger.error(`–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ POI ${poi.name}: ${error.message}`);
        }
      }
    }
    
    return addedCount;
  }

  selectSubcategory(tags, subcategories) {
    // –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–≥–æ–≤ OSM
    if (tags.tourism === 'museum') return '–º—É–∑–µ–π';
    if (tags.amenity === 'restaurant') return '—Ä–µ—Å—Ç–æ—Ä–∞–Ω';
    if (tags.amenity === 'cafe') return '–∫–∞—Ñ–µ';
    if (tags.tourism === 'hotel') return '–æ—Ç–µ–ª—å';
    if (tags.leisure === 'park') return '–ø–∞—Ä–∫';
    if (tags.historic) return '–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –º–µ—Å—Ç–æ';
    
    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
    return subcategories[Math.floor(Math.random() * subcategories.length)];
  }

  sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
}

module.exports = new CityParser();
üìä progress/cities-progress.json
{
  "completed": [],
  "in_progress": null,
  "statistics": {
    "total_cities": 15,
    "completed_cities": 0,
    "total_markers": 0
  }
}
üöÄ index.js (–≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª)
#!/usr/bin/env node

const inquirer = require('inquirer');
const chalk = require('chalk');
const fs = require('fs').promises;
const path = require('path');

const cities = require('./config/cities');
const cityParser = require('./parsers/cityParser');
const databaseService = require('./services/databaseService');
const logger = require('./utils/logger');

class WayAtomParser {
  constructor() {
    this.progressFile = path.join(__dirname, 'progress', 'cities-progress.json');
  }

  async start() {
    console.log(chalk.cyan.bold('\nüó∫Ô∏è  WayAtom Parser v1.0.0\n'));
    console.log(chalk.gray('–ü–∞—Ä—Å–µ—Ä –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç—ã –º–µ—Ç–∫–∞–º–∏ –∏–∑ OpenStreetMap –∏ Wikipedia\n'));

    try {
      await this.loadProgress();
      await this.showMainMenu();
    } catch (error) {
      logger.error(`–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${error.message}`);
      process.exit(1);
    }
  }

  async showMainMenu() {
    const choices = [
      { name: 'üèôÔ∏è  –ü–∞—Ä—Å–∏—Ç—å –≥–æ—Ä–æ–¥', value: 'parse_city' },
      { name: 'üìä –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å', value: 'show_progress' },
      { name: 'üìã –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤', value: 'list_cities' },
      { name: 'üîÑ –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å', value: 'reset_progress' },
      { name: '‚ùå –í—ã—Ö–æ–¥', value: 'exit' }
    ];

    const { action } = await inquirer.prompt([
      {
        type: 'list',
        name: 'action',
        message: '–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:',
        choices
      }
    ]);

    switch (action) {
      case 'parse_city':
        await this.selectCityToParse();
        break;
      case 'show_progress':
        await this.showProgress();
        break;
      case 'list_cities':
        await this.listCities();
        break;
      case 'reset_progress':
        await this.resetProgress();
        break;
      case 'exit':
        console.log(chalk.green('\n–î–æ —Å–≤–∏–¥–∞–Ω–∏—è! üëã\n'));
        process.exit(0);
        break;
    }
  }

  async selectCityToParse() {
    const progress = await this.loadProgress();
    const availableCities = Object.entries(cities)
      .filter(([key]) => !progress.completed.includes(key))
      .map(([key, city]) => ({
        name: `${city.name} (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: ${city.priority})`,
        value: key
      }));

    if (availableCities.length === 0) {
      console.log(chalk.yellow('\n‚úÖ –í—Å–µ –≥–æ—Ä–æ–¥–∞ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã!\n'));
      await this.showMainMenu();
      return;
    }

    const { cityKey } = await inquirer.prompt([
      {
        type: 'list',
        name: 'cityKey',
        message: '–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞:',
        choices: [
          ...availableCities,
          { name: '‚¨ÖÔ∏è  –ù–∞–∑–∞–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é', value: 'back' }
        ]
      }
    ]);

    if (cityKey === 'back') {
      await this.showMainMenu();
      return;
    }

    await this.parseCity(cityKey);
  }

  async parseCity(cityKey) {
    const cityConfig = cities[cityKey];
    
    console.log(chalk.blue(`\nüöÄ –ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä—Å–∏–Ω–≥ –≥–æ—Ä–æ–¥–∞: ${cityConfig.name}\n`));
    
    const startTime = Date.now();
    
    try {
      // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
      const progress = await this.loadProgress();
      progress.in_progress = cityKey;
      await this.saveProgress(progress);

      // –ü–∞—Ä—Å–∏–º –≥–æ—Ä–æ–¥
      const addedMarkers = await cityParser.parseCity(cityConfig);
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
      progress.completed.push(cityKey);
      progress.in_progress = null;
      progress.statistics.completed_cities = progress.completed.length;
      progress.statistics.total_markers = await databaseService.getMarkersCount();
      
      await this.saveProgress(progress);
      
      const duration = Math.round((Date.now() - startTime) / 1000);
      
      console.log(chalk.green(`\n‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!`));
      console.log(chalk.gray(`   –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ${duration} —Å–µ–∫`));
      console.log(chalk.gray(`   –î–æ–±–∞–≤–ª–µ–Ω–æ –º–∞—Ä–∫–µ—Ä–æ–≤: ${addedMarkers}`));
      
    } catch (error) {
      logger.error(`–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –≥–æ—Ä–æ–¥–∞ ${cityConfig.name}: ${error.message}`);
      
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å "–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ"
      const progress = await this.loadProgress();
      progress.in_progress = null;
      await this.saveProgress(progress);
    }
–ü—Ä–æ–¥–æ–ª–∂–∞–π
üöÄ WayAtom Parser - –ü–∞—Ä—Å–∏–Ω–≥–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç—ã
üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É wayatom-parser –≤ –∫–æ—Ä–Ω–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

wayatom-parser/
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ cities.js
‚îÇ   ‚îú‚îÄ‚îÄ categories.js
‚îÇ   ‚îî‚îÄ‚îÄ database.js
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ overpassService.js
‚îÇ   ‚îú‚îÄ‚îÄ wikipediaService.js
‚îÇ   ‚îî‚îÄ‚îÄ databaseService.js
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ logger.js
‚îÇ   ‚îî‚îÄ‚îÄ validator.js
‚îú‚îÄ‚îÄ parsers/
‚îÇ   ‚îî‚îÄ‚îÄ cityParser.js
‚îú‚îÄ‚îÄ progress/
‚îÇ   ‚îî‚îÄ‚îÄ cities-progress.json
‚îî‚îÄ‚îÄ index.js
üì¶ package.json
{
  "name": "wayatom-parser",
  "version": "1.0.0",
  "description": "–ü–∞—Ä—Å–µ—Ä –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç—ã WayAtom –º–µ—Ç–∫–∞–º–∏ –∏–∑ OpenStreetMap –∏ Wikipedia",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "parse": "node index.js --city",
    "progress": "node utils/progress.js"
  },
  "dependencies": {
    "axios": "^1.6.0",
    "pg": "^8.11.0",
    "dotenv": "^16.3.1",
    "chalk": "^4.1.2",
    "inquirer": "^8.2.6",
    "uuid": "^9.0.1"
  },
  "devDependencies": {
    "nodemon": "^3.0.1"
  }
}
üîß .env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
DB_HOST=localhost
DB_PORT=5432
DB_NAME=wayatom
DB_USER=your_username
DB_PASSWORD=your_password

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä—Å–µ—Ä–∞
BATCH_SIZE=50
DELAY_BETWEEN_REQUESTS=1000
MAX_RETRIES=3

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL=info
üèôÔ∏è config/cities.js
module.exports = {
  // –ö—Ä—É–ø–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –†–æ—Å—Å–∏–∏
  moscow: {
    name: '–ú–æ—Å–∫–≤–∞',
    bounds: [55.4922, 37.3193, 55.9579, 37.9678],
    priority: 1
  },
  spb: {
    name: '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',
    bounds: [59.7342, 30.0395, 60.0943, 30.5804],
    priority: 1
  },
  kazan: {
    name: '–ö–∞–∑–∞–Ω—å',
    bounds: [55.6967, 49.0089, 55.8963, 49.2847],
    priority: 2
  },
  novosibirsk: {
    name: '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫',
    bounds: [54.9022, 82.7606, 55.1838, 83.1280],
    priority: 2
  },
  ekaterinburg: {
    name: '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥',
    bounds: [56.7104, 60.4231, 56.9439, 60.7317],
    priority: 2
  },
  nizhny: {
    name: '–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥',
    bounds: [56.1965, 43.7840, 56.3968, 44.1341],
    priority: 2
  },
  samara: {
    name: '–°–∞–º–∞—Ä–∞',
    bounds: [53.1479, 50.0334, 53.2785, 50.3446],
    priority: 3
  },
  omsk: {
    name: '–û–º—Å–∫',
    bounds: [54.8661, 73.2458, 55.0561, 73.4658],
    priority: 3
  },
  rostov: {
    name: '–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É',
    bounds: [47.1692, 39.5991, 47.3092, 39.8191],
    priority: 3
  },
  ufa: {
    name: '–£—Ñ–∞',
    bounds: [54.6269, 55.8569, 54.8469, 56.1769],
    priority: 3
  },
  krasnoyarsk: {
    name: '–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫',
    bounds: [55.9289, 92.7289, 56.1089, 93.0089],
    priority: 3
  },
  vladimir: {
    name: '–í–ª–∞–¥–∏–º–∏—Ä',
    bounds: [56.0784, 40.3284, 56.1784, 40.4484],
    priority: 4
  },
  suzdal: {
    name: '–°—É–∑–¥–∞–ª—å',
    bounds: [56.4084, 40.4284, 56.4384, 40.4584],
    priority: 4
  },
  yaroslavl: {
    name: '–Ø—Ä–æ—Å–ª–∞–≤–ª—å',
    bounds: [57.5584, 39.8284, 57.6584, 39.9484],
    priority: 4
  },
  tula: {
    name: '–¢—É–ª–∞',
    bounds: [54.1584, 37.5784, 54.2584, 37.6984],
    priority: 4
  },
  kaluga: {
    name: '–ö–∞–ª—É–≥–∞',
    bounds: [54.4984, 36.2284, 54.5984, 36.3484],
    priority: 4
  }
};
üè∑Ô∏è config/categories.js
module.exports = {
  attractions: {
    name: '–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏',
    overpass_query: `
      [out:json][timeout:25];
      (
        way["tourism"="attraction"]({{bbox}});
        node["tourism"="attraction"]({{bbox}});
        way["historic"]({{bbox}});
        node["historic"]({{bbox}});
        way["tourism"="viewpoint"]({{bbox}});
        node["tourism"="viewpoint"]({{bbox}});
      );
      out center meta;
    `,
    subcategories: ['–ø–∞–º—è—Ç–Ω–∏–∫', '–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞', '—Å–º–æ—Ç—Ä–æ–≤–∞—è –ø–ª–æ—â–∞–¥–∫–∞', '–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –º–µ—Å—Ç–æ']
  },
  
  museums: {
    name: '–ú—É–∑–µ–∏',
    overpass_query: `
      [out:json][timeout:25];
      (
        way["tourism"="museum"]({{bbox}});
        node["tourism"="museum"]({{bbox}});
        way["amenity"="arts_centre"]({{bbox}});
        node["amenity"="arts_centre"]({{bbox}});
      );
      out center meta;
    `,
    subcategories: ['—Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –º—É–∑–µ–π', '–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –º—É–∑–µ–π', '–Ω–∞—É—á–Ω—ã–π –º—É–∑–µ–π', '–≥–∞–ª–µ—Ä–µ—è']
  },
  
  restaurants: {
    name: '–†–µ—Å—Ç–æ—Ä–∞–Ω—ã',
    overpass_query: `
      [out:json][timeout:25];
      (
        way["amenity"="restaurant"]({{bbox}});
        node["amenity"="restaurant"]({{bbox}});
        way["amenity"="cafe"]({{bbox}});
        node["amenity"="cafe"]({{bbox}});
        way["amenity"="fast_food"]({{bbox}});
        node["amenity"="fast_food"]({{bbox}});
      );
      out center meta;
    `,
    subcategories: ['—Ä–µ—Å—Ç–æ—Ä–∞–Ω', '–∫–∞—Ñ–µ', '–±—ã—Å—Ç—Ä–æ–µ –ø–∏—Ç–∞–Ω–∏–µ', '–±–∞—Ä']
  },
  
  hotels: {
    name: '–û—Ç–µ–ª–∏',
    overpass_query: `
      [out:json][timeout:25];
      (
        way["tourism"="hotel"]({{bbox}});
        node["tourism"="hotel"]({{bbox}});
        way["tourism"="hostel"]({{bbox}});
        node["tourism"="hostel"]({{bbox}});
        way["tourism"="guest_house"]({{bbox}});
        node["tourism"="guest_house"]({{bbox}});
      );
      out center meta;
    `,
    subcategories: ['–æ—Ç–µ–ª—å', '—Ö–æ—Å—Ç–µ–ª', '–≥–æ—Å—Ç–µ–≤–æ–π –¥–æ–º', '–≥–æ—Å—Ç–∏–Ω–∏—Ü–∞']
  },
  
  parks: {
    name: '–ü–∞—Ä–∫–∏',
    overpass_query: `
      [out:json][timeout:25];
      (
        way["leisure"="park"]({{bbox}});
        node["leisure"="park"]({{bbox}});
        way["leisure"="garden"]({{bbox}});
        node["leisure"="garden"]({{bbox}});
        way["natural"="forest"]({{bbox}});
        node["natural"="forest"]({{bbox}});
      );
      out center meta;
    `,
    subcategories: ['–≥–æ—Ä–æ–¥—Å–∫–æ–π –ø–∞—Ä–∫', '—Å–∞–¥', '–ª–µ—Å', '—Å–∫–≤–µ—Ä']
  }
};
üóÑÔ∏è config/database.js
const { Pool } = require('pg');
require('dotenv').config();

const pool = new Pool({
  host: process.env.DB_HOST,
  port: process.env.DB_PORT,
  database: process.env.DB_NAME,
  user: process.env.DB_USER,
  password: process.env.DB_PASSWORD,
});

module.exports = pool;
üåê services/overpassService.js
const axios = require('axios');
const logger = require('../utils/logger');

class OverpassService {
  constructor() {
    this.baseUrl = 'https://overpass-api.de/api/interpreter';
    this.timeout = 30000;
  }

  async queryPOIs(category, bounds) {
    try {
      const [south, west, north, east] = bounds;
      const bbox = `${south},${west},${north},${east}`;
      
      const query = category.overpass_query.replace('{{bbox}}', bbox);
      
      logger.info(`–ó–∞–ø—Ä–æ—Å –∫ Overpass API –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: ${category.name}`);
      
      const response = await axios.post(this.baseUrl, query, {
        timeout: this.timeout,
        headers: {
          'Content-Type': 'text/plain; charset=utf-8'
        }
      });

      const elements = response.data.elements || [];
      logger.info(`–ü–æ–ª—É—á–µ–Ω–æ ${elements.length} –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ${category.name}`);
      
      return this.processElements(elements);
    } catch (error) {
      logger.error(`–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ Overpass API: ${error.message}`);
      return [];
    }
  }

  processElements(elements) {
    return elements.map(element => {
      let lat, lon;
      
      if (element.type === 'node') {
        lat = element.lat;
        lon = element.lon;
      } else if (element.center) {
        lat = element.center.lat;
        lon = element.center.lon;
      } else {
        return null;
      }

      const tags = element.tags || {};
      
      return {
        osm_id: element.id,
        osm_type: element.type,
        name: tags.name || tags['name:ru'] || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è',
        latitude: lat,
        longitude: lon,
        tags: tags,
        address: this.buildAddress(tags)
      };
    }).filter(Boolean);
  }

  buildAddress(tags) {
    const parts = [];
    
    if (tags['addr:street']) parts.push(`—É–ª. ${tags['addr:street']}`);
    if (tags['addr:housenumber']) parts.push(tags['addr:housenumber']);
    if (tags['addr:city']) parts.push(tags['addr:city']);
    
    return parts.length > 0 ? parts.join(', ') : null;
  }
}

module.exports = new OverpassService();
üìö services/wikipediaService.js
const axios = require('axios');
const logger = require('../utils/logger');

class WikipediaService {
  constructor() {
    this.baseUrl = 'https://ru.wikipedia.org/api/rest_v1';
    this.searchUrl = 'https://ru.wikipedia.org/w/api.php';
  }

  async getDescription(title, cityName) {
    try {
      // –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º —Å—Ç–∞—Ç—å—é
      const searchResults = await this.searchArticle(title, cityName);
      
      if (!searchResults || searchResults.length === 0) {
        return this.generateFallbackDescription(title);
      }

      // –ü–æ–ª—É—á–∞–µ–º –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
      const pageTitle = searchResults[0];
      const summary = await this.getPageSummary(pageTitle);
      
      return summary || this.generateFallbackDescription(title);
    } catch (error) {
      logger.warn(`–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è "${title}": ${error.message}`);
      return this.generateFallbackDescription(title);
    }
  }

  async searchArticle(title, cityName) {
    try {
      const searchQueries = [
        `${title} ${cityName}`,
        title,
        `${title} –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å`,
        `${title} –º—É–∑–µ–π`,
        `${title} —Ä–µ—Å—Ç–æ—Ä–∞–Ω`
      ];

      for (const query of searchQueries) {
        const response = await axios.get(this.searchUrl, {
          params: {
            action: 'query',
            format: 'json',
            list: 'search',
            srsearch: query,
            srlimit: 3
          },
          timeout: 10000
        });

        const results = response.data.query?.search || [];
        if (results.length > 0) {
          return results.map(r => r.title);
        }
      }

      return [];
    } catch (error) {
      logger.warn(`–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –≤ Wikipedia: ${error.message}`);
      return [];
    }
  }

  async getPageSummary(pageTitle) {
    try {
      const response = await axios.get(`${this.baseUrl}/page/summary/${encodeURIComponent(pageTitle)}`, {
        timeout: 10000
      });

      const extract = response.data.extract;
      
      if (extract && extract.length > 50) {
        // –û–±—Ä–µ–∑–∞–µ–º –¥–æ —Ä–∞–∑—É–º–Ω–æ–π –¥–ª–∏–Ω—ã
        return extract.length > 300 ? extract.substring(0, 297) + '...' : extract;
      }

      return null;
    } catch (error) {
      logger.warn(`–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã: ${error.message}`);
      return null;
    }
  }

  generateFallbackDescription(title) {
    const templates = [
      `${title} - –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –º–µ—Å—Ç–æ, –∫–æ—Ç–æ—Ä–æ–µ —Å—Ç–æ–∏—Ç –ø–æ—Å–µ—Ç–∏—Ç—å.`,
      `${title} - –æ–¥–Ω–æ –∏–∑ –ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Å—Ç –≤ –≥–æ—Ä–æ–¥–µ.`,
      `${title} - –º–µ—Å—Ç–æ —Å –±–æ–≥–∞—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π –∏ –∫—É–ª—å—Ç—É—Ä–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.`,
      `${title} - –ø–æ–ø—É–ª—è—Ä–Ω–æ–µ –º–µ—Å—Ç–æ —Å—Ä–µ–¥–∏ –∂–∏—Ç–µ–ª–µ–π –∏ —Ç—É—Ä–∏—Å—Ç–æ–≤.`,
      `${title} - –∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è –ø—Ä–∏ –ø–æ—Å–µ—â–µ–Ω–∏–∏ –≥–æ—Ä–æ–¥–∞.`
    ];
    
    return templates[Math.floor(Math.random() * templates.length)];
  }
}

module.exports = new WikipediaService();
üóÑÔ∏è services/databaseService.js
const pool = require('../config/database');
const { v4: uuidv4 } = require('uuid');
const logger = require('../utils/logger');

class DatabaseService {
  async insertMarker(markerData) {
    const client = await pool.connect();
    
    try {
      const query = `
        INSERT INTO markers (
          id, title, description, latitude, longitude, address,
          category, subcategory, author_name, hashtags, 
          is_verified, is_active, visibility, marker_type,
          rating, rating_count, views_count, likes_count, 
          comments_count, shares_count, photo_urls, metadata
        ) VALUES (
          $1, $2, $3, $4, $5, $6, $7, $8, $9, $10,
          $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22
        ) RETURNING id;
      `;

      const values = [
        uuidv4(), // id
        markerData.title,
        markerData.description,
        markerData.latitude,
        markerData.longitude,
        markerData.address,
        markerData.category,
        markerData.subcategory,
        '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', // author_name
        markerData.hashtags || [],
        true, // is_verified
        true, // is_active
        'public', // visibility
        'standard', // marker_type
        0, // rating
        0, // rating_count
        0, // views_count
        0, // likes_count
        0, // comments_count
        0, // shares_count
        [], // photo_urls
        markerData.metadata || {}
      ];

      const result = await client.query(query, values);
      logger.info(`–î–æ–±–∞–≤–ª–µ–Ω –º–∞—Ä–∫–µ—Ä: ${markerData.title}`);
      
      return result.rows[0].id;
    } catch (error) {
      if (error.code === '23505') { // Duplicate key
        logger.warn(`–ú–∞—Ä–∫–µ—Ä —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: ${markerData.title}`);
        return null;
      }
      
      logger.error(`–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ä–∞: ${error.message}`);
      throw error;
    } finally {
      client.release();
    }
  }

  async checkMarkerExists(title, latitude, longitude) {
    try {
      const query = `
        SELECT id FROM markers 
        WHERE title = $1 
        AND ABS(latitude - $2) < 0.001 
        AND ABS(longitude - $3) < 0.001
        LIMIT 1;
      `;
      
      const result = await pool.query(query, [title, latitude, longitude]);
      return result.rows.length > 0;
    } catch (error) {
      logger.error(`–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –º–∞—Ä–∫–µ—Ä–∞: ${error.message}`);
      return false;
    }
  }

  async getMarkersCount() {
    try {
      const result = await pool.query('SELECT COUNT(*) as count FROM markers');
      return parseInt(result.rows[0].count);
    } catch (error) {
      logger.error(`–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∞—Ä–∫–µ—Ä–æ–≤: ${error.message}`);
      return 0;
    }
  }
}

module.exports = new DatabaseService();
üìù utils/logger.js
const chalk = require('chalk');

class Logger {
  info(message) {
    console.log(chalk.blue(`[INFO] ${new Date().toISOString()} - ${message}`));
  }

  warn(message) {
    console.log(chalk.yellow(`[WARN] ${new Date().toISOString()} - ${message}`));
  }

  error(message) {
    console.log(chalk.red(`[ERROR] ${new Date().toISOString()} - ${message}`));
  }

  success(message) {
    console.log(chalk.green(`[SUCCESS] ${new Date().toISOString()} - ${message}`));
  }
}

module.exports = new Logger();
‚úÖ utils/validator.js
class Validator {
  static isValidCoordinate(lat, lon) {
    return (
      typeof lat === 'number' && 
      typeof lon === 'number' &&
      lat >= -90 && lat <= 90 &&
      lon >= -180 && lon <= 180
    );
  }

  static isValidTitle(title) {
    return typeof title === 'string' && title.trim().length > 0;
  }

  static sanitizeTitle(title) {
    return title.trim().replace(/\s+/g, ' ');
  }

  static generateHashtags(title, category, cityName) {
    const hashtags = [];
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≥–æ—Ä–æ–¥
    hashtags.push(cityName.toLowerCase().replace(/\s+/g, ''));
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
    hashtags.push(category.toLowerCase());
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è
    const words = title.toLowerCase().split(/\s+/)
      .filter(word => word.length > 3)
      .slice(0, 2);
    
    hashtags.push(...words);
    
    return [...new Set(hashtags)]; // –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
  }
}

module.exports = Validator;
üèôÔ∏è parsers/cityParser.js
const overpassService = require('../services/overpassService');
const wikipediaService = require('../services/wikipediaService');
const databaseService = require('../services/databaseService');
const validator = require('../utils/validator');
const logger = require('../utils/logger');
const categories = require('../config/categories');

class CityParser {
  constructor() {
    this.delay = parseInt(process.env.DELAY_BETWEEN_REQUESTS) || 1000;
    this.batchSize = parseInt(process.env.BATCH_SIZE) || 50;
  }

  async parseCity(cityConfig) {
    logger.info(`üèôÔ∏è –ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä—Å–∏–Ω–≥ –≥–æ—Ä–æ–¥–∞: ${cityConfig.name}`);
    
    let totalAdded = 0;
    
    for (const [categoryKey, category] of Object.entries(categories)) {
      logger.info(`üìÇ –ü–∞—Ä—Å–∏–Ω–≥ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: ${category.name}`);
      
      try {
        const pois = await overpassService.queryPOIs(category, cityConfig.bounds);
        logger.info(`–ù–∞–π–¥–µ–Ω–æ ${pois.length} –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ${category.name}`);
        
        const processed = await this.processPOIs(pois, category, cityConfig.name);
        totalAdded += processed;
        
        // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
        await this.sleep(this.delay);
        
      } catch (error) {
        logger.error(`–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ${category.name}: ${error.message}`);
      }
    }
    
    logger.success(`‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –≥–æ—Ä–æ–¥–∞ ${cityConfig.name} –∑–∞–≤–µ—Ä—à–µ–Ω. –î–æ–±–∞–≤–ª–µ–Ω–æ: ${totalAdded} –º–∞—Ä–∫–µ—Ä–æ–≤`);
    return totalAdded;
  }

  async processPOIs(pois, category, cityName) {
    let addedCount = 0;
    
    for (let i = 0; i < pois.length; i += this.batchSize) {
      const batch = pois.slice(i, i + this.batchSize);
      
      for (const poi of batch) {
        try {
          if (!validator.isValidCoordinate(poi.latitude, poi.longitude)) {
            continue;
          }

          if (!validator.isValidTitle(poi.name)) {
            continue;
          }

          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–π –º–∞—Ä–∫–µ—Ä
          const exists = await databaseService.checkMarkerExists(
            poi.name, 
            poi.latitude, 
            poi.longitude
          );

          if (exists) {
            continue;
          }

          // –ü–æ–ª—É—á–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑ Wikipedia
          const description = await wikipediaService.getDescription(poi.name, cityName);
          
          // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –º–∞—Ä–∫–µ—Ä–∞
          const markerData = {
            title: validator.sanitizeTitle(poi.name),
            description: description,
            latitude: poi.latitude,
            longitude: poi.longitude,
            address: poi.address,
            category: category.name,
            subcategory: this.selectSubcategory(poi.tags, category.subcategories),
            hashtags: validator.generateHashtags(poi.name, category.name, cityName),
            metadata: {
              osm_id: poi.osm_id,
              osm_type: poi.osm_type,
              source: 'openstreetmap',
              parsed_at: new Date().toISOString()
            }
          };

          // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
          const markerId = await databaseService.insertMarker(markerData);
          
          if (markerId) {
            addedCount++;
            logger.info(`‚ûï –î–æ–±–∞–≤–ª–µ–Ω: ${poi.name}`);
          }

          // –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
          await this.sleep(this.delay / 2);
          
        } catch (error) {
          logger.error(`–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ POI ${poi.name}: ${error.message}`);
        }
      }
    }
    
    return addedCount;
  }

  selectSubcategory(tags, subcategories) {
    // –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–≥–æ–≤ OSM
    if (tags.tourism === 'museum') return '–º—É–∑–µ–π';
    if (tags.amenity === 'restaurant') return '—Ä–µ—Å—Ç–æ—Ä–∞–Ω';
    if (tags.amenity === 'cafe') return '–∫–∞—Ñ–µ';
    if (tags.tourism === 'hotel') return '–æ—Ç–µ–ª—å';
    if (tags.leisure === 'park') return '–ø–∞—Ä–∫';
    if (tags.historic) return '–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–µ –º–µ—Å—Ç–æ';
    
    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
    return subcategories[Math.floor(Math.random() * subcategories.length)];
  }

  sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
}

module.exports = new CityParser();
üìä progress/cities-progress.json
{
  "completed": [],
  "in_progress": null,
  "statistics": {
    "total_cities": 15,
    "completed_cities": 0,
    "total_markers": 0
  }
}
üöÄ index.js (–≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª)
#!/usr/bin/env node

const inquirer = require('inquirer');
const chalk = require('chalk');
const fs = require('fs').promises;
const path = require('path');

const cities = require('./config/cities');
const cityParser = require('./parsers/cityParser');
const databaseService = require('./services/databaseService');
const logger = require('./utils/logger');

class WayAtomParser {
  constructor() {
    this.progressFile = path.join(__dirname, 'progress', 'cities-progress.json');
  }

  async start() {
    console.log(chalk.cyan.bold('\nüó∫Ô∏è  WayAtom Parser v1.0.0\n'));
    console.log(chalk.gray('–ü–∞—Ä—Å–µ—Ä –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç—ã –º–µ—Ç–∫–∞–º–∏ –∏–∑ OpenStreetMap –∏ Wikipedia\n'));

    try {
      await this.loadProgress();
      await this.showMainMenu();
    } catch (error) {
      logger.error(`–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ${error.message}`);
      process.exit(1);
    }
  }

  async showMainMenu() {
    const choices = [
      { name: 'üèôÔ∏è  –ü–∞—Ä—Å–∏—Ç—å –≥–æ—Ä–æ–¥', value: 'parse_city' },
      { name: 'üìä –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å', value: 'show_progress' },
      { name: 'üìã –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤', value: 'list_cities' },
      { name: 'üîÑ –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å', value: 'reset_progress' },
      { name: '‚ùå –í—ã—Ö–æ–¥', value: 'exit' }
    ];

    const { action } = await inquirer.prompt([
      {
        type: 'list',
        name: 'action',
        message: '–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:',
        choices
      }
    ]);

    switch (action) {
      case 'parse_city':
        await this.selectCityToParse();
        break;
      case 'show_progress':
        await this.showProgress();
        break;
      case 'list_cities':
        await this.listCities();
        break;
      case 'reset_progress':
        await this.resetProgress();
        break;
      case 'exit':
        console.log(chalk.green('\n–î–æ —Å–≤–∏–¥–∞–Ω–∏—è! üëã\n'));
        process.exit(0);
        break;
    }
  }

  async selectCityToParse() {
    const progress = await this.loadProgress();
    const availableCities = Object.entries(cities)
      .filter(([key]) => !progress.completed.includes(key))
      .map(([key, city]) => ({
        name: `${city.name} (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: ${city.priority})`,
        value: key
      }));

    if (availableCities.length === 0) {
      console.log(chalk.yellow('\n‚úÖ –í—Å–µ –≥–æ—Ä–æ–¥–∞ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã!\n'));
      await this.showMainMenu();
      return;
    }

    const { cityKey } = await inquirer.prompt([
      {
        type: 'list',
        name: 'cityKey',
        message: '–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞:',
        choices: [
          ...availableCities,
          { name: '‚¨ÖÔ∏è  –ù–∞–∑–∞–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é', value: 'back' }
        ]
      }
    ]);

    if (cityKey === 'back') {
      await this.showMainMenu();
      return;
    }

    await this.parseCity(cityKey);
  }

  async parseCity(cityKey) {
    const cityConfig = cities[cityKey];
    
    console.log(chalk.blue(`\nüöÄ –ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä—Å–∏–Ω–≥ –≥–æ—Ä–æ–¥–∞: ${cityConfig.name}\n`));
    
    const startTime = Date.now();
    
    try {
      // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
      const progress = await this.loadProgress();
      progress.in_progress = cityKey;
      await this.saveProgress(progress);

      // –ü–∞—Ä—Å–∏–º –≥–æ—Ä–æ–¥
      const addedMarkers = await cityParser.parseCity(cityConfig);
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
      progress.completed.push(cityKey);
      progress.in_progress = null;
      progress.statistics.completed_cities = progress.completed.length;
      progress.statistics.total_markers = await databaseService.getMarkersCount();
      
      await this.saveProgress(progress);
      
      const duration = Math.round((Date.now() - startTime) / 1000);
      
      console.log(chalk.green(`\n‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!`));
      console.log(chalk.gray(`   –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ${duration} —Å–µ–∫`));
      console.log(chalk.gray(`   –î–æ–±–∞–≤–ª–µ–Ω–æ –º–∞—Ä–∫–µ—Ä–æ–≤: ${addedMarkers}`));
      
    } catch (error) {
      logger.error(`–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –≥–æ—Ä–æ–¥–∞ ${cityConfig.name}: ${error.message}`);
      
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å "–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ"
      const progress = await this.loadProgress();
      progress.in_progress = null;
      await this.saveProgress(progress);
    }

    console.log(chalk.blue('\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...'));
    await inquirer.prompt([{ type: 'input
–¢—ã –≤—Å—ë, –∏–ª–∏ —á—Ç–æ —Ç–æ –Ω–µ –¥–æ–ø–∏—Å–∞–ª –µ—â–µ?
Navigated to github.com/simamakis/bestsite
Navigate to site

// Navigate to URL
await page.goto("https://github.com/simamakis/bestsite");
–î–∞, —è –Ω–µ –¥–æ–ø–∏—Å–∞–ª! –ü—Ä–æ–¥–æ–ª–∂–∞—é —Å —Ç–æ–≥–æ –º–µ—Å—Ç–∞, –≥–¥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è:

    console.log(chalk.blue('\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...'));
    await inquirer.prompt([{ type: 'input', name: 'continue', message: '' }]);
    
    await this.showMainMenu();
  }

  async showProgress() {
    const progress = await this.loadProgress();
    const totalCities = Object.keys(cities).length;
    
    console.log(chalk.cyan('\nüìä –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–∞—Ä—Å–∏–Ω–≥–∞:\n'));
    console.log(chalk.gray(`–í—Å–µ–≥–æ –≥–æ—Ä–æ–¥–æ–≤: ${totalCities}`));
    console.log(chalk.green(`–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: ${progress.completed.length}`));
    console.log(chalk.yellow(`–û—Å—Ç–∞–ª–æ—Å—å: ${totalCities - progress.completed.length}`));
    console.log(chalk.blue(`–í—Å–µ–≥–æ –º–µ—Ç–æ–∫: ${progress.statistics.total_markers}`));
    
    if (progress.in_progress) {
      console.log(chalk.yellow(`\n–í –ø—Ä–æ—Ü–µ—Å—Å–µ: ${cities[progress.in_progress].name}`));
    }
    
    if (progress.completed.length > 0) {
      console.log(chalk.green('\n–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –≥–æ—Ä–æ–¥–∞:'));
      progress.completed.forEach(cityKey => {
        console.log(chalk.gray(`  ‚úÖ ${cities[cityKey].name}`));
      });
    }
    
    console.log(chalk.blue('\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...'));
    await inquirer.prompt([{ type: 'input', name: 'continue', message: '' }]);
    
    await this.showMainMenu();
  }

  async listCities() {
    console.log(chalk.cyan('\nüìã –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤:\n'));
    
    Object.entries(cities).forEach(([key, city]) => {
      const status = this.isCompleted(key) ? '‚úÖ' : '‚è≥';
      console.log(chalk.gray(`  ${status} ${city.name} (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: ${city.priority})`));
    });
    
    console.log(chalk.blue('\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...'));
    await inquirer.prompt([{ type: 'input', name: 'continue', message: '' }]);
    
    await this.showMainMenu();
  }

  async resetProgress() {
    const { confirm } = await inquirer.prompt([
      {
        type: 'confirm',
        name: 'confirm',
        message: '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å?',
        default: false
      }
    ]);

    if (confirm) {
      const defaultProgress = {
        completed: [],
        in_progress: null,
        statistics: {
          total_cities: Object.keys(cities).length,
          completed_cities: 0,
          total_markers: await databaseService.getMarkersCount()
        }
      };
      
      await this.saveProgress(defaultProgress);
      console.log(chalk.green('\n‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–æ—à–µ–Ω!'));
    }
    
    await this.showMainMenu();
  }

  async loadProgress() {
    try {
      const data = await fs.readFile(this.progressFile, 'utf8');
      return JSON.parse(data);
    } catch (error) {
      // –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª –ø—Ä–æ–≥—Ä–µ—Å—Å–∞, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
      const defaultProgress = {
        completed: [],
        in_progress: null,
        statistics: {
          total_cities: Object.keys(cities).length,
          completed_cities: 0,
          total_markers: 0
        }
      };
      
      await this.saveProgress(defaultProgress);
      return defaultProgress;
    }
  }

  async saveProgress(progress) {
    try {
      await fs.writeFile(this.progressFile, JSON.stringify(progress, null, 2));
    } catch (error) {
      logger.error(`–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞: ${error.message}`);
    }
  }

  isCompleted(cityKey) {
    // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞
    return false; // –ë—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
  }
}

// –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞
if (require.main === module) {
  const parser = new WayAtomParser();
  parser.start().catch(error => {
    console.error(chalk.red('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞:'), error);
    process.exit(1);
  });
}

module.exports = WayAtomParser;
üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –∑–∞–ø—É—Å–∫—É
1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø–∞—Ä—Å–µ—Ä–∞
cd wayatom-parser

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ:

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
DB_HOST=localhost
DB_PORT=5432
DB_NAME=wayatom
DB_USER=your_username
DB_PASSWORD=your_password

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä—Å–µ—Ä–∞
BATCH_SIZE=30
DELAY_BETWEEN_REQUESTS=2000
MAX_RETRIES=3

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL=info
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –≤–∞—à–µ–π PostgreSQL –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ markers —Å –ø–æ–ª—è–º–∏:

id (UUID)
title (VARCHAR)
description (TEXT)
latitude (NUMERIC)
longitude (NUMERIC)
address (TEXT)
category (VARCHAR)
subcategory (VARCHAR)
author_name (VARCHAR)
hashtags (TEXT[])
is_verified (BOOLEAN)
is_active (BOOLEAN)
visibility (VARCHAR)
marker_type (VARCHAR)
rating (NUMERIC)
rating_count (INTEGER)
views_count (INTEGER)
likes_count (INTEGER)
comments_count (INTEGER)
shares_count (INTEGER)
photo_urls (TEXT[])
metadata (JSONB)
4. –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞
# –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
npm start

# –ò–ª–∏ –ø—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫
node index.js
5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥ –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å —á–µ—Ä–µ–∑ –º–µ–Ω—é
–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
–°–±—Ä–∞—Å—ã–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–∞—Ä—Å–µ—Ä–∞
‚úÖ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–∞—Ä—Å–µ—Ä:
–ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ OpenStreetMap —á–µ—Ä–µ–∑ Overpass API
–û–±–æ–≥–∞—â–∞–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è —á–µ—Ä–µ–∑ Wikipedia API –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ö–µ—à—Ç–µ–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∞–≤—Ç–æ—Ä–∞ –∫–∞–∫ "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä"
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
–õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ü–≤–µ—Ç–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
–ó–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ (–Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ–º API)
–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–µ—Ç–æ–∫
üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
–¶–≤–µ—Ç–Ω–æ–π –ª–æ–≥ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
–°—á–µ—Ç—á–∏–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫
–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –≥–æ—Ä–æ–¥–∞–º
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ JSON —Ñ–∞–π–ª–µ
–¢–µ–ø–µ—Ä—å –ø–∞—Ä—Å–µ—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ

–ó–∞–ø—É—Å–∫–∞–π—Ç–µ –∏ –Ω–∞—á–∏–Ω–∞–π—Ç–µ –∑–∞–ø–æ–ª–Ω—è—Ç—å –≤–∞—à—É –∫–∞—Ä—Ç—É WayAtom –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –∏–∑ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.