# API –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:
```bash
psql -U your_user -d your_database -f create_gamification_tables.sql
```

2. –†–æ—É—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –≤ `server.js`

## –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`).

### –£—Ä–æ–≤–Ω–∏

#### GET `/api/gamification/level/:userId?`
–ü–æ–ª—É—á–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–û—Ç–≤–µ—Ç:**
```json
{
  "level": 5,
  "currentXP": 150,
  "requiredXP": 519,
  "totalXP": 2000,
  "rank": "explorer",
  "progress": 28.9
}
```

### XP

#### POST `/api/gamification/xp`
–î–æ–±–∞–≤–∏—Ç—å XP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "source": "post_created",
  "amount": 50,
  "contentId": "uuid-–ø–æ—Å—Ç–∞",
  "contentType": "post",
  "metadata": {
    "hasPhoto": true,
    "hasMarker": true
  }
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "newLevel": 5,
  "levelUp": false,
  "totalXP": 2050,
  "currentLevelXP": 200,
  "requiredXP": 519
}
```

**–û—à–∏–±–∫–∏:**
- `400` - –î—É–±–ª–∏–∫–∞—Ç –¥–µ–π—Å—Ç–≤–∏—è (—É–∂–µ –Ω–∞—á–∏—Å–ª–µ–Ω XP –∑–∞ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ)
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `500` - –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —Ü–µ–ª–∏

#### GET `/api/gamification/daily-goals`
–ü–æ–ª—É—á–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —Ü–µ–ª–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è.

**–û—Ç–≤–µ—Ç:**
```json
{
  "goals": [
    {
      "id": "uuid",
      "goal_id": "goal_123",
      "type": "create_posts",
      "title": "–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç—ã",
      "description": "–°–æ–∑–¥–∞–π—Ç–µ 2 –ø–æ—Å—Ç–∞",
      "target": 2,
      "current": 1,
      "completed": false,
      "xp_reward": 50,
      "difficulty": "medium",
      "icon": "üìù",
      "date": "2024-01-15"
    }
  ]
}
```

#### POST `/api/gamification/goals/:goalId/complete`
–í—ã–ø–æ–ª–Ω–∏—Ç—å —Ü–µ–ª—å.

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "goal": { ... }
}
```

#### POST `/api/gamification/daily-reward/claim`
–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Ü–µ–ª–µ–π.

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "bonusXP": 100
}
```

### –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è

#### GET `/api/gamification/achievements`
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–û—Ç–≤–µ—Ç:**
```json
{
  "achievements": [
    {
      "id": "uuid",
      "achievement_id": "first_post",
      "unlocked": true,
      "unlocked_at": "2024-01-15T10:00:00Z",
      "progress_current": 1,
      "progress_target": 1
    }
  ]
}
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

#### GET `/api/gamification/stats`
–ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏.

**–û—Ç–≤–µ—Ç:**
```json
{
  "userLevel": {
    "level": 5,
    "currentXP": 150,
    "requiredXP": 519,
    "totalXP": 2000,
    "rank": "explorer",
    "progress": 28.9
  },
  "achievements": {
    "total": 20,
    "unlocked": 5,
    "byRarity": {}
  },
  "dailyGoals": {
    "current": [...],
    "streak": 7,
    "todayProgress": 75
  },
  "recentXP": []
}
```

## –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–∞–∫—Ä—É—Ç–æ–∫

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏–π** - —Ç–∞–±–ª–∏—Ü–∞ `gamification_actions` –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ XP –∑–∞ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –¥–µ–π—Å—Ç–≤–∏–µ
2. **–ú–æ–¥–µ—Ä–∞—Ü–∏—è** - XP –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º (–ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ)
3. **–õ–∏–º–∏—Ç—ã** - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ª–∏–º–∏—Ç–æ–≤ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ

## –§–æ—Ä–º—É–ª–∞ —É—Ä–æ–≤–Ω–µ–π

```
XP_—Ç—Ä–µ–±—É–µ–º–æ–µ = 100 * —É—Ä–æ–≤–µ–Ω—å^1.5
```

–ü—Ä–∏–º–µ—Ä—ã:
- –£—Ä–æ–≤–µ–Ω—å 1: 100 XP
- –£—Ä–æ–≤–µ–Ω—å 5: 1118 XP
- –£—Ä–æ–≤–µ–Ω—å 10: 3162 XP
- –£—Ä–æ–≤–µ–Ω—å 20: 8944 XP

## –†–∞–Ω–≥–∏

- **novice** (1-5): –ù–æ–≤–∏—á–æ–∫ üå±
- **explorer** (6-15): –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å üîç
- **traveler** (16-30): –ü—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫ üß≠
- **legend** (31-49): –õ–µ–≥–µ–Ω–¥–∞ ‚≠ê
- **geoblogger** (50+): –ì–µ–æ–ë–ª–æ–≥–≥–µ—Ä üëë

